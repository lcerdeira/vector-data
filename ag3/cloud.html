
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ag3 cloud data access &#8212; MalariaGEN vector data user guide</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ag3 data downloads" href="download.html" />
    <link rel="prev" title="Introduction to Ag3" href="intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">MalariaGEN vector data user guide</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../landing-page.html">
   MalariaGEN vector data user guide
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Ag3 (Ag1000G phase 3)
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction to Ag3
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Ag3 cloud data access
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="download.html">
   Ag3 data downloads
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="examples.html">
   Ag3 analysis examples
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="examples/collection-sites.html">
     Mosquito collection sites
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ag3/cloud.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/malariagen/vector-data"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/malariagen/vector-data/issues/new?title=Issue%20on%20page%20%2Fag3/cloud.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://gke.mybinder.org/v2/gh/malariagen/vector-data/master?urlpath=tree/docs/ag3/cloud.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/malariagen/vector-data/blob/master/docs/ag3/cloud.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-hosting">
   Data hosting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sample-sets">
   Sample sets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sample-metadata">
   Sample metadata
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#snp-sites-and-alleles">
   SNP sites and alleles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#site-filters">
   Site filters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#snp-genotypes">
   SNP genotypes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-larger-computations">
   Running larger computations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feedback-and-suggestions">
   Feedback and suggestions
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="ag3-cloud-data-access">
<h1>Ag3 cloud data access<a class="headerlink" href="#ag3-cloud-data-access" title="Permalink to this headline">¶</a></h1>
<p>This page provides information about how to access data from <a class="reference internal" href="intro.html"><span class="doc std std-doc"><em>Anopheles gambiae</em> 1000 Genomes project (Ag1000G) phase 3</span></a> via Google Cloud. This includes sample metadata and single nucleotide polymorphism (SNP) calls.</p>
<p>This notebook illustrates how to read data directly from the cloud, without having to first download any data locally. This notebook can be run from any computer, but will work best when run from a compute node within Google Cloud, because it will be physically closer to the data and so data transfer is faster. For example, this notebook can be run via <a class="reference external" href="https://gke.mybinder.org">MyBinder</a> or <a class="reference external" href="https://colab.research.google.com/">Google Colab</a> which are free interactive computing service running in the cloud.</p>
<p>To launch this notebook in the cloud and run it for yourself, click the launch icon (<i class="fas fa-rocket"></i>) at the top of the page and select one of the cloud computing services available.</p>
<div class="section" id="data-hosting">
<h2>Data hosting<a class="headerlink" href="#data-hosting" title="Permalink to this headline">¶</a></h2>
<p>All data required for this notebook is hosted on Google Cloud Storage (GCS). Data are hosted in the <code class="docutils literal notranslate"><span class="pre">vo_agam_release</span></code> bucket, which is a multi-region bucket located in the United States. All data hosted in GCS are publicly accessible and do not require any authentication to access.</p>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>Running this notebook requires the following Python packages to be installed: numpy, dask, zarr, gcsfs, fsspec. These packages can be installed via pip or conda. E.g.:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install -q numpy dask<span class="o">[</span>array<span class="o">]</span> zarr gcsfs fsspec
</pre></div>
</div>
</div>
</div>
<p>To make accessing these data more convenient, we’ve also created a <a class="reference external" href="https://github.com/malariagen/malariagen-data-python">malariagen_data Python package</a>, which is available from PyPI. This is experimental so please let us know if you find any bugs or have any suggestions. The <code class="docutils literal notranslate"><span class="pre">malariagen_data</span></code> package can be installed via pip, e.g.:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install -q malariagen-data
</pre></div>
</div>
</div>
</div>
<p>Once installed, data access from Google Cloud is set up with the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">malariagen_data</span>
<span class="n">ag3</span> <span class="o">=</span> <span class="n">malariagen_data</span><span class="o">.</span><span class="n">Ag3</span><span class="p">(</span><span class="s2">&quot;gs://vo_agam_release/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sample-sets">
<h2>Sample sets<a class="headerlink" href="#sample-sets" title="Permalink to this headline">¶</a></h2>
<p>Data in this release are organised into 28 sample sets. Each of these sample sets corresponds to a set of mosquito specimens contributed by a collaborating study. Depending on your objectives, you may want to access data from only specific sample sets, or all sample sets.</p>
<p>To see which sample sets are available, load the sample set manifest into a pandas dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_sample_sets</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">sample_sets</span><span class="p">()</span>
<span class="n">df_sample_sets</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_set</th>
      <th>sample_count</th>
      <th>release</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AG1000G-AO</td>
      <td>81</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AG1000G-BF-A</td>
      <td>181</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AG1000G-BF-B</td>
      <td>102</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AG1000G-BF-C</td>
      <td>13</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AG1000G-CD</td>
      <td>76</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AG1000G-CF</td>
      <td>73</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AG1000G-CI</td>
      <td>80</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AG1000G-CM-A</td>
      <td>303</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AG1000G-CM-B</td>
      <td>97</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AG1000G-CM-C</td>
      <td>44</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AG1000G-FR</td>
      <td>23</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AG1000G-GA-A</td>
      <td>69</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AG1000G-GH</td>
      <td>100</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>13</th>
      <td>AG1000G-GM-A</td>
      <td>74</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>AG1000G-GM-B</td>
      <td>31</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>AG1000G-GM-C</td>
      <td>174</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>AG1000G-GN-A</td>
      <td>45</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>17</th>
      <td>AG1000G-GN-B</td>
      <td>185</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>18</th>
      <td>AG1000G-GQ</td>
      <td>10</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>19</th>
      <td>AG1000G-GW</td>
      <td>101</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>AG1000G-KE</td>
      <td>86</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>AG1000G-ML-A</td>
      <td>60</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>22</th>
      <td>AG1000G-ML-B</td>
      <td>71</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>23</th>
      <td>AG1000G-MW</td>
      <td>41</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>24</th>
      <td>AG1000G-MZ</td>
      <td>74</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>25</th>
      <td>AG1000G-TZ</td>
      <td>300</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>26</th>
      <td>AG1000G-UG</td>
      <td>290</td>
      <td>v3</td>
    </tr>
    <tr>
      <th>27</th>
      <td>AG1000G-X</td>
      <td>297</td>
      <td>v3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For more information about these sample sets, see the section on sample sets in the <a class="reference internal" href="intro.html"><span class="doc std std-doc">introduction to Ag1000G phase 3</span></a>.</p>
</div>
<div class="section" id="sample-metadata">
<h2>Sample metadata<a class="headerlink" href="#sample-metadata" title="Permalink to this headline">¶</a></h2>
<p>Data about the samples that were sequenced to generate this data resource are available, including the time and place of collection, the gender of the specimen, and our call regarding the species of the specimen. These are organised by sample set.</p>
<p>E.g., load sample metadata for the AG1000G-BF-A and AG1000G-BF-B sample sets into a pandas dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_samples</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">sample_metadata</span><span class="p">(</span><span class="n">sample_sets</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;AG1000G-BF-A&quot;</span><span class="p">,</span> <span class="s2">&quot;AG1000G-BF-B&quot;</span><span class="p">])</span>
<span class="n">df_samples</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>partner_sample_id</th>
      <th>contributor</th>
      <th>country</th>
      <th>location</th>
      <th>year</th>
      <th>month</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>sex_call</th>
      <th>sample_set</th>
      <th>release</th>
      <th>aim_fraction_colu</th>
      <th>aim_fraction_arab</th>
      <th>species_gambcolu_arabiensis</th>
      <th>species_gambiae_coluzzii</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AB0085-Cx</td>
      <td>BF2-4</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Pala</td>
      <td>2012</td>
      <td>7</td>
      <td>11.150</td>
      <td>-4.235</td>
      <td>F</td>
      <td>AG1000G-BF-A</td>
      <td>v3</td>
      <td>0.024</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AB0086-Cx</td>
      <td>BF2-6</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Pala</td>
      <td>2012</td>
      <td>7</td>
      <td>11.150</td>
      <td>-4.235</td>
      <td>F</td>
      <td>AG1000G-BF-A</td>
      <td>v3</td>
      <td>0.038</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AB0087-C</td>
      <td>BF3-3</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Bana</td>
      <td>2012</td>
      <td>7</td>
      <td>11.233</td>
      <td>-4.472</td>
      <td>F</td>
      <td>AG1000G-BF-A</td>
      <td>v3</td>
      <td>0.982</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AB0088-C</td>
      <td>BF3-5</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Bana</td>
      <td>2012</td>
      <td>7</td>
      <td>11.233</td>
      <td>-4.472</td>
      <td>F</td>
      <td>AG1000G-BF-A</td>
      <td>v3</td>
      <td>0.990</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AB0089-Cx</td>
      <td>BF3-8</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Bana</td>
      <td>2012</td>
      <td>7</td>
      <td>11.233</td>
      <td>-4.472</td>
      <td>F</td>
      <td>AG1000G-BF-A</td>
      <td>v3</td>
      <td>0.975</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>278</th>
      <td>AB0533-C</td>
      <td>BF13-18</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Souroukoudinga</td>
      <td>2014</td>
      <td>7</td>
      <td>11.235</td>
      <td>-4.535</td>
      <td>F</td>
      <td>AG1000G-BF-B</td>
      <td>v3</td>
      <td>0.021</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>279</th>
      <td>AB0536-C</td>
      <td>BF13-31</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Souroukoudinga</td>
      <td>2014</td>
      <td>7</td>
      <td>11.235</td>
      <td>-4.535</td>
      <td>F</td>
      <td>AG1000G-BF-B</td>
      <td>v3</td>
      <td>0.025</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>280</th>
      <td>AB0537-C</td>
      <td>BF13-32</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Souroukoudinga</td>
      <td>2014</td>
      <td>7</td>
      <td>11.235</td>
      <td>-4.535</td>
      <td>F</td>
      <td>AG1000G-BF-B</td>
      <td>v3</td>
      <td>0.029</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>281</th>
      <td>AB0538-C</td>
      <td>BF13-33</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Souroukoudinga</td>
      <td>2014</td>
      <td>7</td>
      <td>11.235</td>
      <td>-4.535</td>
      <td>F</td>
      <td>AG1000G-BF-B</td>
      <td>v3</td>
      <td>0.018</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>282</th>
      <td>AB0408-C</td>
      <td>BF14-20</td>
      <td>Austin Burt</td>
      <td>Burkina Faso</td>
      <td>Bana</td>
      <td>2014</td>
      <td>7</td>
      <td>11.233</td>
      <td>-4.472</td>
      <td>F</td>
      <td>AG1000G-BF-B</td>
      <td>v3</td>
      <td>0.986</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
  </tbody>
</table>
<p>283 rows × 17 columns</p>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sample_id</span></code> column gives the sample identifier used throughout all Ag1000G analyses.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">country</span></code>, <code class="docutils literal notranslate"><span class="pre">location</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span></code> columns give the location where the specimen was collected.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">year</span></code> and <code class="docutils literal notranslate"><span class="pre">month</span></code> columns give the approximate date when the specimen was collected.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sex_call</span></code> column gives the gender as determined from the sequence data.</p>
<p>To load metadata for all wild-caught samples, you can use the shortcut “v3_wild”, e.g.:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_samples</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">sample_metadata</span><span class="p">(</span><span class="n">sample_sets</span><span class="o">=</span><span class="s2">&quot;v3_wild&quot;</span><span class="p">)</span>
<span class="n">df_samples</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>partner_sample_id</th>
      <th>contributor</th>
      <th>country</th>
      <th>location</th>
      <th>year</th>
      <th>month</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>sex_call</th>
      <th>sample_set</th>
      <th>release</th>
      <th>aim_fraction_colu</th>
      <th>aim_fraction_arab</th>
      <th>species_gambcolu_arabiensis</th>
      <th>species_gambiae_coluzzii</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AR0047-C</td>
      <td>LUA047</td>
      <td>Joao Pinto</td>
      <td>Angola</td>
      <td>Luanda</td>
      <td>2009</td>
      <td>4</td>
      <td>-8.884</td>
      <td>13.302</td>
      <td>F</td>
      <td>AG1000G-AO</td>
      <td>v3</td>
      <td>0.945</td>
      <td>0.001</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AR0049-C</td>
      <td>LUA049</td>
      <td>Joao Pinto</td>
      <td>Angola</td>
      <td>Luanda</td>
      <td>2009</td>
      <td>4</td>
      <td>-8.884</td>
      <td>13.302</td>
      <td>F</td>
      <td>AG1000G-AO</td>
      <td>v3</td>
      <td>0.933</td>
      <td>0.001</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AR0051-C</td>
      <td>LUA051</td>
      <td>Joao Pinto</td>
      <td>Angola</td>
      <td>Luanda</td>
      <td>2009</td>
      <td>4</td>
      <td>-8.884</td>
      <td>13.302</td>
      <td>F</td>
      <td>AG1000G-AO</td>
      <td>v3</td>
      <td>0.937</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AR0061-C</td>
      <td>LUA061</td>
      <td>Joao Pinto</td>
      <td>Angola</td>
      <td>Luanda</td>
      <td>2009</td>
      <td>4</td>
      <td>-8.884</td>
      <td>13.302</td>
      <td>F</td>
      <td>AG1000G-AO</td>
      <td>v3</td>
      <td>0.938</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AR0078-C</td>
      <td>LUA078</td>
      <td>Joao Pinto</td>
      <td>Angola</td>
      <td>Luanda</td>
      <td>2009</td>
      <td>4</td>
      <td>-8.884</td>
      <td>13.302</td>
      <td>F</td>
      <td>AG1000G-AO</td>
      <td>v3</td>
      <td>0.926</td>
      <td>0.001</td>
      <td>gamb_colu</td>
      <td>coluzzii</td>
      <td>coluzzii</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2779</th>
      <td>AC0295-C</td>
      <td>K92</td>
      <td>Martin Donnelly</td>
      <td>Uganda</td>
      <td>Kihihi</td>
      <td>2012</td>
      <td>11</td>
      <td>-0.751</td>
      <td>29.701</td>
      <td>F</td>
      <td>AG1000G-UG</td>
      <td>v3</td>
      <td>0.026</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>2780</th>
      <td>AC0296-C</td>
      <td>K93</td>
      <td>Martin Donnelly</td>
      <td>Uganda</td>
      <td>Kihihi</td>
      <td>2012</td>
      <td>11</td>
      <td>-0.751</td>
      <td>29.701</td>
      <td>F</td>
      <td>AG1000G-UG</td>
      <td>v3</td>
      <td>0.029</td>
      <td>0.003</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>2781</th>
      <td>AC0297-C</td>
      <td>K94</td>
      <td>Martin Donnelly</td>
      <td>Uganda</td>
      <td>Kihihi</td>
      <td>2012</td>
      <td>11</td>
      <td>-0.751</td>
      <td>29.701</td>
      <td>F</td>
      <td>AG1000G-UG</td>
      <td>v3</td>
      <td>0.026</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>2782</th>
      <td>AC0298-C</td>
      <td>K95</td>
      <td>Martin Donnelly</td>
      <td>Uganda</td>
      <td>Kihihi</td>
      <td>2012</td>
      <td>11</td>
      <td>-0.751</td>
      <td>29.701</td>
      <td>F</td>
      <td>AG1000G-UG</td>
      <td>v3</td>
      <td>0.029</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
    <tr>
      <th>2783</th>
      <td>AC0299-C</td>
      <td>K96</td>
      <td>Martin Donnelly</td>
      <td>Uganda</td>
      <td>Kihihi</td>
      <td>2012</td>
      <td>11</td>
      <td>-0.751</td>
      <td>29.701</td>
      <td>F</td>
      <td>AG1000G-UG</td>
      <td>v3</td>
      <td>0.029</td>
      <td>0.002</td>
      <td>gamb_colu</td>
      <td>gambiae</td>
      <td>gambiae</td>
    </tr>
  </tbody>
</table>
<p>2784 rows × 17 columns</p>
</div></div></div>
</div>
<p>Pandas can be used to explore and query the sample metadata in various ways. E.g., here is a summary of the numbers of samples by species:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_samples</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;species&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>species
arabiensis                          368
coluzzii                            675
gambiae                            1571
intermediate_arabiensis_gambiae       1
intermediate_gambiae_coluzzii       169
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Note that samples within a sample set may belong to different species. For convenience, we have made a species call for all samples in Ag1000G phase 3, using the genomic data. Calling species is not always straightforward, and we have used two different methods for species calling, ancestry informative markers (AIM) and principal components analysis (PCA). When loading the sample metadata, the AIM species calls are included by default. The results of these two different methods generally agree, although there are some populations where results are different, particularly in Guinea-Bissau, The Gambia, Kenya and Tanzania. If you have any questions about how to interpret these species calls, please get in touch.</p>
</div>
<div class="section" id="snp-sites-and-alleles">
<h2>SNP sites and alleles<a class="headerlink" href="#snp-sites-and-alleles" title="Permalink to this headline">¶</a></h2>
<p>We have called SNP genotypes in all samples at all positions in the genome where the reference allele is not “N”. Data on this set of genomic positions and alleles for a given chromosome arm (e.g., 3R) can be accessed as dask arrays as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">alt</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">snp_sites</span><span class="p">(</span><span class="s2">&quot;3R&quot;</span><span class="p">)</span>
<span class="n">pos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 208.91 MB </td> <td> 2.10 MB </td></tr>
    <tr><th> Shape </th><td> (52226568,) </td> <td> (524288,) </td></tr>
    <tr><th> Count </th><td> 101 Tasks </td><td> 100 Chunks </td></tr>
    <tr><th> Type </th><td> int32 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="1" y1="0" x2="1" y2="25" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="4" y1="0" x2="4" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="8" y1="0" x2="8" y2="25" />
  <line x1="9" y1="0" x2="9" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="16" y1="0" x2="16" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="19" y1="0" x2="19" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="21" y1="0" x2="21" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="24" y1="0" x2="24" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="27" y1="0" x2="27" y2="25" />
  <line x1="28" y1="0" x2="28" y2="25" />
  <line x1="30" y1="0" x2="30" y2="25" />
  <line x1="31" y1="0" x2="31" y2="25" />
  <line x1="32" y1="0" x2="32" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="34" y1="0" x2="34" y2="25" />
  <line x1="36" y1="0" x2="36" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="38" y1="0" x2="38" y2="25" />
  <line x1="39" y1="0" x2="39" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="42" y1="0" x2="42" y2="25" />
  <line x1="43" y1="0" x2="43" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="45" y1="0" x2="45" y2="25" />
  <line x1="46" y1="0" x2="46" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="49" y1="0" x2="49" y2="25" />
  <line x1="50" y1="0" x2="50" y2="25" />
  <line x1="51" y1="0" x2="51" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="54" y1="0" x2="54" y2="25" />
  <line x1="55" y1="0" x2="55" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="57" y1="0" x2="57" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="60" y1="0" x2="60" y2="25" />
  <line x1="61" y1="0" x2="61" y2="25" />
  <line x1="62" y1="0" x2="62" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="65" y1="0" x2="65" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="68" y1="0" x2="68" y2="25" />
  <line x1="69" y1="0" x2="69" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="72" y1="0" x2="72" y2="25" />
  <line x1="73" y1="0" x2="73" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="75" y1="0" x2="75" y2="25" />
  <line x1="77" y1="0" x2="77" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="79" y1="0" x2="79" y2="25" />
  <line x1="80" y1="0" x2="80" y2="25" />
  <line x1="81" y1="0" x2="81" y2="25" />
  <line x1="83" y1="0" x2="83" y2="25" />
  <line x1="84" y1="0" x2="84" y2="25" />
  <line x1="85" y1="0" x2="85" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="87" y1="0" x2="87" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="90" y1="0" x2="90" y2="25" />
  <line x1="91" y1="0" x2="91" y2="25" />
  <line x1="92" y1="0" x2="92" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="95" y1="0" x2="95" y2="25" />
  <line x1="96" y1="0" x2="96" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="98" y1="0" x2="98" y2="25" />
  <line x1="99" y1="0" x2="99" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="102" y1="0" x2="102" y2="25" />
  <line x1="103" y1="0" x2="103" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="106" y1="0" x2="106" y2="25" />
  <line x1="107" y1="0" x2="107" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="109" y1="0" x2="109" y2="25" />
  <line x1="110" y1="0" x2="110" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="113" y1="0" x2="113" y2="25" />
  <line x1="114" y1="0" x2="114" y2="25" />
  <line x1="115" y1="0" x2="115" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="118" y1="0" x2="118" y2="25" />
  <line x1="119" y1="0" x2="119" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.000000,0.000000 120.000000,0.000000 120.000000,25.412617 0.000000,25.412617" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >52226568</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 52.23 MB </td> <td> 524.29 kB </td></tr>
    <tr><th> Shape </th><td> (52226568,) </td> <td> (524288,) </td></tr>
    <tr><th> Count </th><td> 101 Tasks </td><td> 100 Chunks </td></tr>
    <tr><th> Type </th><td> |S1 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="1" y1="0" x2="1" y2="25" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="4" y1="0" x2="4" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="8" y1="0" x2="8" y2="25" />
  <line x1="9" y1="0" x2="9" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="16" y1="0" x2="16" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="19" y1="0" x2="19" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="21" y1="0" x2="21" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="24" y1="0" x2="24" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="27" y1="0" x2="27" y2="25" />
  <line x1="28" y1="0" x2="28" y2="25" />
  <line x1="30" y1="0" x2="30" y2="25" />
  <line x1="31" y1="0" x2="31" y2="25" />
  <line x1="32" y1="0" x2="32" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="34" y1="0" x2="34" y2="25" />
  <line x1="36" y1="0" x2="36" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="38" y1="0" x2="38" y2="25" />
  <line x1="39" y1="0" x2="39" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="42" y1="0" x2="42" y2="25" />
  <line x1="43" y1="0" x2="43" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="45" y1="0" x2="45" y2="25" />
  <line x1="46" y1="0" x2="46" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="49" y1="0" x2="49" y2="25" />
  <line x1="50" y1="0" x2="50" y2="25" />
  <line x1="51" y1="0" x2="51" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="54" y1="0" x2="54" y2="25" />
  <line x1="55" y1="0" x2="55" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="57" y1="0" x2="57" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="60" y1="0" x2="60" y2="25" />
  <line x1="61" y1="0" x2="61" y2="25" />
  <line x1="62" y1="0" x2="62" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="65" y1="0" x2="65" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="68" y1="0" x2="68" y2="25" />
  <line x1="69" y1="0" x2="69" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="72" y1="0" x2="72" y2="25" />
  <line x1="73" y1="0" x2="73" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="75" y1="0" x2="75" y2="25" />
  <line x1="77" y1="0" x2="77" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="79" y1="0" x2="79" y2="25" />
  <line x1="80" y1="0" x2="80" y2="25" />
  <line x1="81" y1="0" x2="81" y2="25" />
  <line x1="83" y1="0" x2="83" y2="25" />
  <line x1="84" y1="0" x2="84" y2="25" />
  <line x1="85" y1="0" x2="85" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="87" y1="0" x2="87" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="90" y1="0" x2="90" y2="25" />
  <line x1="91" y1="0" x2="91" y2="25" />
  <line x1="92" y1="0" x2="92" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="95" y1="0" x2="95" y2="25" />
  <line x1="96" y1="0" x2="96" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="98" y1="0" x2="98" y2="25" />
  <line x1="99" y1="0" x2="99" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="102" y1="0" x2="102" y2="25" />
  <line x1="103" y1="0" x2="103" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="106" y1="0" x2="106" y2="25" />
  <line x1="107" y1="0" x2="107" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="109" y1="0" x2="109" y2="25" />
  <line x1="110" y1="0" x2="110" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="113" y1="0" x2="113" y2="25" />
  <line x1="114" y1="0" x2="114" y2="25" />
  <line x1="115" y1="0" x2="115" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="118" y1="0" x2="118" y2="25" />
  <line x1="119" y1="0" x2="119" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.000000,0.000000 120.000000,0.000000 120.000000,25.412617 0.000000,25.412617" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >52226568</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 156.68 MB </td> <td> 1.57 MB </td></tr>
    <tr><th> Shape </th><td> (52226568, 3) </td> <td> (524288, 3) </td></tr>
    <tr><th> Count </th><td> 101 Tasks </td><td> 100 Chunks </td></tr>
    <tr><th> Type </th><td> |S1 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="25" y2="1" />
  <line x1="0" y1="2" x2="25" y2="2" />
  <line x1="0" y1="3" x2="25" y2="3" />
  <line x1="0" y1="4" x2="25" y2="4" />
  <line x1="0" y1="6" x2="25" y2="6" />
  <line x1="0" y1="7" x2="25" y2="7" />
  <line x1="0" y1="8" x2="25" y2="8" />
  <line x1="0" y1="9" x2="25" y2="9" />
  <line x1="0" y1="10" x2="25" y2="10" />
  <line x1="0" y1="12" x2="25" y2="12" />
  <line x1="0" y1="13" x2="25" y2="13" />
  <line x1="0" y1="14" x2="25" y2="14" />
  <line x1="0" y1="15" x2="25" y2="15" />
  <line x1="0" y1="16" x2="25" y2="16" />
  <line x1="0" y1="18" x2="25" y2="18" />
  <line x1="0" y1="19" x2="25" y2="19" />
  <line x1="0" y1="20" x2="25" y2="20" />
  <line x1="0" y1="21" x2="25" y2="21" />
  <line x1="0" y1="22" x2="25" y2="22" />
  <line x1="0" y1="24" x2="25" y2="24" />
  <line x1="0" y1="25" x2="25" y2="25" />
  <line x1="0" y1="26" x2="25" y2="26" />
  <line x1="0" y1="27" x2="25" y2="27" />
  <line x1="0" y1="28" x2="25" y2="28" />
  <line x1="0" y1="30" x2="25" y2="30" />
  <line x1="0" y1="31" x2="25" y2="31" />
  <line x1="0" y1="32" x2="25" y2="32" />
  <line x1="0" y1="33" x2="25" y2="33" />
  <line x1="0" y1="34" x2="25" y2="34" />
  <line x1="0" y1="36" x2="25" y2="36" />
  <line x1="0" y1="37" x2="25" y2="37" />
  <line x1="0" y1="38" x2="25" y2="38" />
  <line x1="0" y1="39" x2="25" y2="39" />
  <line x1="0" y1="40" x2="25" y2="40" />
  <line x1="0" y1="42" x2="25" y2="42" />
  <line x1="0" y1="43" x2="25" y2="43" />
  <line x1="0" y1="44" x2="25" y2="44" />
  <line x1="0" y1="45" x2="25" y2="45" />
  <line x1="0" y1="46" x2="25" y2="46" />
  <line x1="0" y1="48" x2="25" y2="48" />
  <line x1="0" y1="49" x2="25" y2="49" />
  <line x1="0" y1="50" x2="25" y2="50" />
  <line x1="0" y1="51" x2="25" y2="51" />
  <line x1="0" y1="53" x2="25" y2="53" />
  <line x1="0" y1="54" x2="25" y2="54" />
  <line x1="0" y1="55" x2="25" y2="55" />
  <line x1="0" y1="56" x2="25" y2="56" />
  <line x1="0" y1="57" x2="25" y2="57" />
  <line x1="0" y1="59" x2="25" y2="59" />
  <line x1="0" y1="60" x2="25" y2="60" />
  <line x1="0" y1="61" x2="25" y2="61" />
  <line x1="0" y1="62" x2="25" y2="62" />
  <line x1="0" y1="63" x2="25" y2="63" />
  <line x1="0" y1="65" x2="25" y2="65" />
  <line x1="0" y1="66" x2="25" y2="66" />
  <line x1="0" y1="67" x2="25" y2="67" />
  <line x1="0" y1="68" x2="25" y2="68" />
  <line x1="0" y1="69" x2="25" y2="69" />
  <line x1="0" y1="71" x2="25" y2="71" />
  <line x1="0" y1="72" x2="25" y2="72" />
  <line x1="0" y1="73" x2="25" y2="73" />
  <line x1="0" y1="74" x2="25" y2="74" />
  <line x1="0" y1="75" x2="25" y2="75" />
  <line x1="0" y1="77" x2="25" y2="77" />
  <line x1="0" y1="78" x2="25" y2="78" />
  <line x1="0" y1="79" x2="25" y2="79" />
  <line x1="0" y1="80" x2="25" y2="80" />
  <line x1="0" y1="81" x2="25" y2="81" />
  <line x1="0" y1="83" x2="25" y2="83" />
  <line x1="0" y1="84" x2="25" y2="84" />
  <line x1="0" y1="85" x2="25" y2="85" />
  <line x1="0" y1="86" x2="25" y2="86" />
  <line x1="0" y1="87" x2="25" y2="87" />
  <line x1="0" y1="89" x2="25" y2="89" />
  <line x1="0" y1="90" x2="25" y2="90" />
  <line x1="0" y1="91" x2="25" y2="91" />
  <line x1="0" y1="92" x2="25" y2="92" />
  <line x1="0" y1="93" x2="25" y2="93" />
  <line x1="0" y1="95" x2="25" y2="95" />
  <line x1="0" y1="96" x2="25" y2="96" />
  <line x1="0" y1="97" x2="25" y2="97" />
  <line x1="0" y1="98" x2="25" y2="98" />
  <line x1="0" y1="99" x2="25" y2="99" />
  <line x1="0" y1="101" x2="25" y2="101" />
  <line x1="0" y1="102" x2="25" y2="102" />
  <line x1="0" y1="103" x2="25" y2="103" />
  <line x1="0" y1="104" x2="25" y2="104" />
  <line x1="0" y1="106" x2="25" y2="106" />
  <line x1="0" y1="107" x2="25" y2="107" />
  <line x1="0" y1="108" x2="25" y2="108" />
  <line x1="0" y1="109" x2="25" y2="109" />
  <line x1="0" y1="110" x2="25" y2="110" />
  <line x1="0" y1="112" x2="25" y2="112" />
  <line x1="0" y1="113" x2="25" y2="113" />
  <line x1="0" y1="114" x2="25" y2="114" />
  <line x1="0" y1="115" x2="25" y2="115" />
  <line x1="0" y1="116" x2="25" y2="116" />
  <line x1="0" y1="118" x2="25" y2="118" />
  <line x1="0" y1="119" x2="25" y2="119" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.000000,0.000000 25.412617,0.000000 25.412617,120.000000 0.000000,120.000000" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">52226568</text>
</svg>
</td>
</tr>
</table></div></div>
</div>
<p>Data can be loaded into memory as numpy arrays as shown in the following examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read first 10 SNP positions into a numpy array</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10], dtype=int32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read first 10 SNP reference alleles</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">ref</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([b&#39;C&#39;, b&#39;C&#39;, b&#39;T&#39;, b&#39;C&#39;, b&#39;T&#39;, b&#39;A&#39;, b&#39;C&#39;, b&#39;G&#39;, b&#39;T&#39;, b&#39;T&#39;],
      dtype=&#39;|S1&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read first 10 SNP alternate alleles</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">alt</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[b&#39;A&#39;, b&#39;T&#39;, b&#39;G&#39;],
       [b&#39;A&#39;, b&#39;T&#39;, b&#39;G&#39;],
       [b&#39;A&#39;, b&#39;C&#39;, b&#39;G&#39;],
       [b&#39;A&#39;, b&#39;T&#39;, b&#39;G&#39;],
       [b&#39;A&#39;, b&#39;C&#39;, b&#39;G&#39;],
       [b&#39;C&#39;, b&#39;T&#39;, b&#39;G&#39;],
       [b&#39;A&#39;, b&#39;T&#39;, b&#39;G&#39;],
       [b&#39;A&#39;, b&#39;C&#39;, b&#39;T&#39;],
       [b&#39;A&#39;, b&#39;C&#39;, b&#39;G&#39;],
       [b&#39;A&#39;, b&#39;C&#39;, b&#39;G&#39;]], dtype=&#39;|S1&#39;)
</pre></div>
</div>
</div>
</div>
<p>Note that we have chosen to genotype all samples at all sites in the genome, assuming all possible SNP alleles. Not all of these alternate alleles will actually have been observed in the Ag3 samples. To determine which sites and alleles are segregating, an allele count can be performed over the samples you are interested in. See the example below.</p>
</div>
<div class="section" id="site-filters">
<h2>Site filters<a class="headerlink" href="#site-filters" title="Permalink to this headline">¶</a></h2>
<p>SNP calling is not always reliable, and we have created some site filters to allow excluding low quality SNPs.</p>
<p>Because different species may have different genome accessibility issues, we have created three separate site filters:</p>
<ul class="simple">
<li><p>The “gamb_colu” filter is design for working only with <em>An. gambiae</em> and/or <em>An. coluzzii</em> samples.</p></li>
<li><p>The “arab” filter is designed for working with <em>An. arabiensis</em> samples.</p></li>
<li><p>The “gamb_colu_arab” filter is suitable for when analysing samples of any species together.</p></li>
</ul>
<p>Each set of site filters provides a “filter_pass” Boolean mask for each chromosome arm, where True indicates that the site passed the filter and is accessible to high quality SNP calling.</p>
<p>The site filters data can be accessed as dask arrays as shown in the examples below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># access gamb_colu_arab site filters for chromosome arm 3R as a dask array</span>
<span class="n">filter_pass</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">site_filters</span><span class="p">(</span><span class="s2">&quot;3R&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s2">&quot;gamb_colu_arab&quot;</span><span class="p">)</span>
<span class="n">filter_pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 52.23 MB </td> <td> 300.00 kB </td></tr>
    <tr><th> Shape </th><td> (52226568,) </td> <td> (300000,) </td></tr>
    <tr><th> Count </th><td> 176 Tasks </td><td> 175 Chunks </td></tr>
    <tr><th> Type </th><td> bool </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="0" y1="0" x2="0" y2="25" />
  <line x1="1" y1="0" x2="1" y2="25" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="3" y1="0" x2="3" y2="25" />
  <line x1="4" y1="0" x2="4" y2="25" />
  <line x1="4" y1="0" x2="4" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="8" y1="0" x2="8" y2="25" />
  <line x1="8" y1="0" x2="8" y2="25" />
  <line x1="9" y1="0" x2="9" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="11" y1="0" x2="11" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="16" y1="0" x2="16" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="19" y1="0" x2="19" y2="25" />
  <line x1="19" y1="0" x2="19" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="21" y1="0" x2="21" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="23" y1="0" x2="23" y2="25" />
  <line x1="24" y1="0" x2="24" y2="25" />
  <line x1="24" y1="0" x2="24" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="27" y1="0" x2="27" y2="25" />
  <line x1="28" y1="0" x2="28" y2="25" />
  <line x1="28" y1="0" x2="28" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="30" y1="0" x2="30" y2="25" />
  <line x1="31" y1="0" x2="31" y2="25" />
  <line x1="31" y1="0" x2="31" y2="25" />
  <line x1="32" y1="0" x2="32" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" />
  <line x1="34" y1="0" x2="34" y2="25" />
  <line x1="35" y1="0" x2="35" y2="25" />
  <line x1="35" y1="0" x2="35" y2="25" />
  <line x1="36" y1="0" x2="36" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="37" y1="0" x2="37" y2="25" />
  <line x1="38" y1="0" x2="38" y2="25" />
  <line x1="39" y1="0" x2="39" y2="25" />
  <line x1="39" y1="0" x2="39" y2="25" />
  <line x1="40" y1="0" x2="40" y2="25" />
  <line x1="41" y1="0" x2="41" y2="25" />
  <line x1="42" y1="0" x2="42" y2="25" />
  <line x1="42" y1="0" x2="42" y2="25" />
  <line x1="43" y1="0" x2="43" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="44" y1="0" x2="44" y2="25" />
  <line x1="45" y1="0" x2="45" y2="25" />
  <line x1="46" y1="0" x2="46" y2="25" />
  <line x1="46" y1="0" x2="46" y2="25" />
  <line x1="47" y1="0" x2="47" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="48" y1="0" x2="48" y2="25" />
  <line x1="49" y1="0" x2="49" y2="25" />
  <line x1="50" y1="0" x2="50" y2="25" />
  <line x1="51" y1="0" x2="51" y2="25" />
  <line x1="51" y1="0" x2="51" y2="25" />
  <line x1="52" y1="0" x2="52" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="53" y1="0" x2="53" y2="25" />
  <line x1="54" y1="0" x2="54" y2="25" />
  <line x1="55" y1="0" x2="55" y2="25" />
  <line x1="55" y1="0" x2="55" y2="25" />
  <line x1="56" y1="0" x2="56" y2="25" />
  <line x1="57" y1="0" x2="57" y2="25" />
  <line x1="57" y1="0" x2="57" y2="25" />
  <line x1="58" y1="0" x2="58" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="59" y1="0" x2="59" y2="25" />
  <line x1="60" y1="0" x2="60" y2="25" />
  <line x1="61" y1="0" x2="61" y2="25" />
  <line x1="62" y1="0" x2="62" y2="25" />
  <line x1="62" y1="0" x2="62" y2="25" />
  <line x1="63" y1="0" x2="63" y2="25" />
  <line x1="64" y1="0" x2="64" y2="25" />
  <line x1="64" y1="0" x2="64" y2="25" />
  <line x1="65" y1="0" x2="65" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" />
  <line x1="66" y1="0" x2="66" y2="25" />
  <line x1="67" y1="0" x2="67" y2="25" />
  <line x1="68" y1="0" x2="68" y2="25" />
  <line x1="68" y1="0" x2="68" y2="25" />
  <line x1="69" y1="0" x2="69" y2="25" />
  <line x1="70" y1="0" x2="70" y2="25" />
  <line x1="70" y1="0" x2="70" y2="25" />
  <line x1="71" y1="0" x2="71" y2="25" />
  <line x1="72" y1="0" x2="72" y2="25" />
  <line x1="73" y1="0" x2="73" y2="25" />
  <line x1="73" y1="0" x2="73" y2="25" />
  <line x1="74" y1="0" x2="74" y2="25" />
  <line x1="75" y1="0" x2="75" y2="25" />
  <line x1="75" y1="0" x2="75" y2="25" />
  <line x1="76" y1="0" x2="76" y2="25" />
  <line x1="77" y1="0" x2="77" y2="25" />
  <line x1="77" y1="0" x2="77" y2="25" />
  <line x1="78" y1="0" x2="78" y2="25" />
  <line x1="79" y1="0" x2="79" y2="25" />
  <line x1="79" y1="0" x2="79" y2="25" />
  <line x1="80" y1="0" x2="80" y2="25" />
  <line x1="81" y1="0" x2="81" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="82" y1="0" x2="82" y2="25" />
  <line x1="83" y1="0" x2="83" y2="25" />
  <line x1="84" y1="0" x2="84" y2="25" />
  <line x1="84" y1="0" x2="84" y2="25" />
  <line x1="85" y1="0" x2="85" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="86" y1="0" x2="86" y2="25" />
  <line x1="87" y1="0" x2="87" y2="25" />
  <line x1="88" y1="0" x2="88" y2="25" />
  <line x1="88" y1="0" x2="88" y2="25" />
  <line x1="89" y1="0" x2="89" y2="25" />
  <line x1="90" y1="0" x2="90" y2="25" />
  <line x1="90" y1="0" x2="90" y2="25" />
  <line x1="91" y1="0" x2="91" y2="25" />
  <line x1="92" y1="0" x2="92" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="93" y1="0" x2="93" y2="25" />
  <line x1="94" y1="0" x2="94" y2="25" />
  <line x1="95" y1="0" x2="95" y2="25" />
  <line x1="95" y1="0" x2="95" y2="25" />
  <line x1="96" y1="0" x2="96" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="97" y1="0" x2="97" y2="25" />
  <line x1="98" y1="0" x2="98" y2="25" />
  <line x1="99" y1="0" x2="99" y2="25" />
  <line x1="99" y1="0" x2="99" y2="25" />
  <line x1="100" y1="0" x2="100" y2="25" />
  <line x1="101" y1="0" x2="101" y2="25" />
  <line x1="102" y1="0" x2="102" y2="25" />
  <line x1="102" y1="0" x2="102" y2="25" />
  <line x1="103" y1="0" x2="103" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="104" y1="0" x2="104" y2="25" />
  <line x1="105" y1="0" x2="105" y2="25" />
  <line x1="106" y1="0" x2="106" y2="25" />
  <line x1="106" y1="0" x2="106" y2="25" />
  <line x1="107" y1="0" x2="107" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="108" y1="0" x2="108" y2="25" />
  <line x1="109" y1="0" x2="109" y2="25" />
  <line x1="110" y1="0" x2="110" y2="25" />
  <line x1="110" y1="0" x2="110" y2="25" />
  <line x1="111" y1="0" x2="111" y2="25" />
  <line x1="112" y1="0" x2="112" y2="25" />
  <line x1="113" y1="0" x2="113" y2="25" />
  <line x1="113" y1="0" x2="113" y2="25" />
  <line x1="114" y1="0" x2="114" y2="25" />
  <line x1="115" y1="0" x2="115" y2="25" />
  <line x1="115" y1="0" x2="115" y2="25" />
  <line x1="116" y1="0" x2="116" y2="25" />
  <line x1="117" y1="0" x2="117" y2="25" />
  <line x1="117" y1="0" x2="117" y2="25" />
  <line x1="118" y1="0" x2="118" y2="25" />
  <line x1="119" y1="0" x2="119" y2="25" />
  <line x1="119" y1="0" x2="119" y2="25" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.000000,0.000000 120.000000,0.000000 120.000000,25.412617 0.000000,25.412617" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >52226568</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read filter values for first 10 SNPs (True means the site passes filters)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">filter_pass</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([False, False, False, False, False, False, False, False, False,
       False])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="snp-genotypes">
<h2>SNP genotypes<a class="headerlink" href="#snp-genotypes" title="Permalink to this headline">¶</a></h2>
<p>SNP genotypes for individual samples are available. Genotypes are stored as a three-dimensional array, where the first dimension corresponds to genomic positions, the second dimension is samples, and the third dimension is ploidy (2). Values coded as integers, where -1 represents a missing value, 0 represents the reference allele, and 1, 2, and 3 represent alternate alleles.</p>
<p>SNP genotypes can be accessed as dask arrays as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gt</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">snp_genotypes</span><span class="p">(</span><span class="s2">&quot;3R&quot;</span><span class="p">,</span> <span class="n">sample_sets</span><span class="o">=</span><span class="s2">&quot;v3_wild&quot;</span><span class="p">)</span>
<span class="n">gt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 290.80 GB </td> <td> 30.00 MB </td></tr>
    <tr><th> Shape </th><td> (52226568, 2784, 2) </td> <td> (300000, 50, 2) </td></tr>
    <tr><th> Count </th><td> 23827 Tasks </td><td> 11900 Chunks </td></tr>
    <tr><th> Type </th><td> int8 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="156" height="146" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="0" x2="80" y2="71" />
  <line x1="10" y1="0" x2="80" y2="71" />
  <line x1="10" y1="1" x2="80" y2="71" />
  <line x1="10" y1="1" x2="80" y2="72" />
  <line x1="10" y1="2" x2="80" y2="72" />
  <line x1="10" y1="2" x2="80" y2="72" />
  <line x1="10" y1="2" x2="80" y2="73" />
  <line x1="10" y1="3" x2="80" y2="73" />
  <line x1="10" y1="3" x2="80" y2="73" />
  <line x1="10" y1="3" x2="80" y2="74" />
  <line x1="10" y1="3" x2="80" y2="74" />
  <line x1="10" y1="4" x2="80" y2="74" />
  <line x1="10" y1="4" x2="80" y2="75" />
  <line x1="10" y1="4" x2="80" y2="75" />
  <line x1="10" y1="5" x2="80" y2="75" />
  <line x1="10" y1="5" x2="80" y2="76" />
  <line x1="10" y1="5" x2="80" y2="76" />
  <line x1="10" y1="6" x2="80" y2="77" />
  <line x1="10" y1="6" x2="80" y2="77" />
  <line x1="10" y1="7" x2="80" y2="77" />
  <line x1="10" y1="7" x2="80" y2="78" />
  <line x1="10" y1="8" x2="80" y2="78" />
  <line x1="10" y1="8" x2="80" y2="78" />
  <line x1="10" y1="8" x2="80" y2="79" />
  <line x1="10" y1="9" x2="80" y2="79" />
  <line x1="10" y1="9" x2="80" y2="80" />
  <line x1="10" y1="9" x2="80" y2="80" />
  <line x1="10" y1="10" x2="80" y2="80" />
  <line x1="10" y1="10" x2="80" y2="81" />
  <line x1="10" y1="10" x2="80" y2="81" />
  <line x1="10" y1="11" x2="80" y2="81" />
  <line x1="10" y1="11" x2="80" y2="82" />
  <line x1="10" y1="12" x2="80" y2="82" />
  <line x1="10" y1="12" x2="80" y2="82" />
  <line x1="10" y1="12" x2="80" y2="83" />
  <line x1="10" y1="13" x2="80" y2="83" />
  <line x1="10" y1="13" x2="80" y2="84" />
  <line x1="10" y1="13" x2="80" y2="84" />
  <line x1="10" y1="14" x2="80" y2="84" />
  <line x1="10" y1="14" x2="80" y2="85" />
  <line x1="10" y1="15" x2="80" y2="85" />
  <line x1="10" y1="15" x2="80" y2="86" />
  <line x1="10" y1="15" x2="80" y2="86" />
  <line x1="10" y1="16" x2="80" y2="86" />
  <line x1="10" y1="16" x2="80" y2="87" />
  <line x1="10" y1="16" x2="80" y2="87" />
  <line x1="10" y1="16" x2="80" y2="87" />
  <line x1="10" y1="17" x2="80" y2="88" />
  <line x1="10" y1="17" x2="80" y2="88" />
  <line x1="10" y1="18" x2="80" y2="88" />
  <line x1="10" y1="18" x2="80" y2="88" />
  <line x1="10" y1="18" x2="80" y2="89" />
  <line x1="10" y1="18" x2="80" y2="89" />
  <line x1="10" y1="19" x2="80" y2="89" />
  <line x1="10" y1="19" x2="80" y2="90" />
  <line x1="10" y1="20" x2="80" y2="90" />
  <line x1="10" y1="20" x2="80" y2="91" />
  <line x1="10" y1="20" x2="80" y2="91" />
  <line x1="10" y1="21" x2="80" y2="91" />
  <line x1="10" y1="21" x2="80" y2="92" />
  <line x1="10" y1="22" x2="80" y2="92" />
  <line x1="10" y1="22" x2="80" y2="93" />
  <line x1="10" y1="23" x2="80" y2="93" />
  <line x1="10" y1="23" x2="80" y2="94" />
  <line x1="10" y1="24" x2="80" y2="94" />
  <line x1="10" y1="24" x2="80" y2="95" />
  <line x1="10" y1="25" x2="80" y2="95" />
  <line x1="10" y1="25" x2="80" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="25" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="10" y1="0" x2="10" y2="26" />
  <line x1="11" y1="1" x2="11" y2="26" />
  <line x1="11" y1="1" x2="11" y2="27" />
  <line x1="12" y1="2" x2="12" y2="27" />
  <line x1="12" y1="2" x2="12" y2="27" />
  <line x1="12" y1="2" x2="12" y2="28" />
  <line x1="13" y1="3" x2="13" y2="28" />
  <line x1="13" y1="3" x2="13" y2="29" />
  <line x1="14" y1="4" x2="14" y2="29" />
  <line x1="14" y1="4" x2="14" y2="29" />
  <line x1="14" y1="4" x2="14" y2="30" />
  <line x1="15" y1="5" x2="15" y2="30" />
  <line x1="15" y1="5" x2="15" y2="31" />
  <line x1="16" y1="6" x2="16" y2="31" />
  <line x1="16" y1="6" x2="16" y2="31" />
  <line x1="16" y1="6" x2="16" y2="32" />
  <line x1="17" y1="7" x2="17" y2="32" />
  <line x1="17" y1="7" x2="17" y2="33" />
  <line x1="18" y1="8" x2="18" y2="33" />
  <line x1="18" y1="8" x2="18" y2="33" />
  <line x1="18" y1="8" x2="18" y2="34" />
  <line x1="19" y1="9" x2="19" y2="34" />
  <line x1="19" y1="9" x2="19" y2="35" />
  <line x1="20" y1="10" x2="20" y2="35" />
  <line x1="20" y1="10" x2="20" y2="35" />
  <line x1="20" y1="10" x2="20" y2="36" />
  <line x1="21" y1="11" x2="21" y2="36" />
  <line x1="21" y1="11" x2="21" y2="37" />
  <line x1="22" y1="12" x2="22" y2="37" />
  <line x1="22" y1="12" x2="22" y2="37" />
  <line x1="22" y1="12" x2="22" y2="38" />
  <line x1="23" y1="13" x2="23" y2="38" />
  <line x1="23" y1="13" x2="23" y2="39" />
  <line x1="24" y1="14" x2="24" y2="39" />
  <line x1="24" y1="14" x2="24" y2="40" />
  <line x1="25" y1="15" x2="25" y2="40" />
  <line x1="25" y1="15" x2="25" y2="40" />
  <line x1="25" y1="15" x2="25" y2="41" />
  <line x1="26" y1="16" x2="26" y2="41" />
  <line x1="26" y1="16" x2="26" y2="42" />
  <line x1="27" y1="17" x2="27" y2="42" />
  <line x1="27" y1="17" x2="27" y2="42" />
  <line x1="27" y1="17" x2="27" y2="43" />
  <line x1="28" y1="18" x2="28" y2="43" />
  <line x1="28" y1="18" x2="28" y2="44" />
  <line x1="29" y1="19" x2="29" y2="44" />
  <line x1="29" y1="19" x2="29" y2="44" />
  <line x1="29" y1="19" x2="29" y2="45" />
  <line x1="30" y1="20" x2="30" y2="45" />
  <line x1="30" y1="20" x2="30" y2="46" />
  <line x1="31" y1="21" x2="31" y2="46" />
  <line x1="31" y1="21" x2="31" y2="46" />
  <line x1="31" y1="21" x2="31" y2="47" />
  <line x1="32" y1="22" x2="32" y2="47" />
  <line x1="32" y1="22" x2="32" y2="48" />
  <line x1="33" y1="23" x2="33" y2="48" />
  <line x1="33" y1="23" x2="33" y2="48" />
  <line x1="33" y1="23" x2="33" y2="49" />
  <line x1="34" y1="24" x2="34" y2="49" />
  <line x1="34" y1="24" x2="34" y2="50" />
  <line x1="35" y1="25" x2="35" y2="50" />
  <line x1="35" y1="25" x2="35" y2="50" />
  <line x1="35" y1="25" x2="35" y2="51" />
  <line x1="36" y1="26" x2="36" y2="51" />
  <line x1="36" y1="26" x2="36" y2="52" />
  <line x1="37" y1="27" x2="37" y2="52" />
  <line x1="37" y1="27" x2="37" y2="52" />
  <line x1="37" y1="27" x2="37" y2="53" />
  <line x1="38" y1="28" x2="38" y2="53" />
  <line x1="38" y1="28" x2="38" y2="54" />
  <line x1="39" y1="29" x2="39" y2="54" />
  <line x1="39" y1="29" x2="39" y2="55" />
  <line x1="40" y1="30" x2="40" y2="55" />
  <line x1="40" y1="30" x2="40" y2="55" />
  <line x1="40" y1="30" x2="40" y2="56" />
  <line x1="41" y1="31" x2="41" y2="56" />
  <line x1="41" y1="31" x2="41" y2="57" />
  <line x1="42" y1="32" x2="42" y2="57" />
  <line x1="42" y1="32" x2="42" y2="57" />
  <line x1="42" y1="32" x2="42" y2="58" />
  <line x1="43" y1="33" x2="43" y2="58" />
  <line x1="43" y1="33" x2="43" y2="59" />
  <line x1="44" y1="34" x2="44" y2="59" />
  <line x1="44" y1="34" x2="44" y2="59" />
  <line x1="44" y1="34" x2="44" y2="60" />
  <line x1="45" y1="35" x2="45" y2="60" />
  <line x1="45" y1="35" x2="45" y2="61" />
  <line x1="46" y1="36" x2="46" y2="61" />
  <line x1="46" y1="36" x2="46" y2="61" />
  <line x1="46" y1="36" x2="46" y2="62" />
  <line x1="47" y1="37" x2="47" y2="62" />
  <line x1="47" y1="37" x2="47" y2="63" />
  <line x1="48" y1="38" x2="48" y2="63" />
  <line x1="48" y1="38" x2="48" y2="63" />
  <line x1="48" y1="38" x2="48" y2="64" />
  <line x1="49" y1="39" x2="49" y2="64" />
  <line x1="49" y1="39" x2="49" y2="65" />
  <line x1="50" y1="40" x2="50" y2="65" />
  <line x1="50" y1="40" x2="50" y2="65" />
  <line x1="50" y1="40" x2="50" y2="66" />
  <line x1="51" y1="41" x2="51" y2="66" />
  <line x1="51" y1="41" x2="51" y2="67" />
  <line x1="52" y1="42" x2="52" y2="67" />
  <line x1="52" y1="42" x2="52" y2="67" />
  <line x1="52" y1="42" x2="52" y2="68" />
  <line x1="53" y1="43" x2="53" y2="68" />
  <line x1="53" y1="43" x2="53" y2="69" />
  <line x1="54" y1="44" x2="54" y2="69" />
  <line x1="54" y1="44" x2="54" y2="70" />
  <line x1="55" y1="45" x2="55" y2="70" />
  <line x1="55" y1="45" x2="55" y2="70" />
  <line x1="55" y1="45" x2="55" y2="71" />
  <line x1="56" y1="46" x2="56" y2="71" />
  <line x1="56" y1="46" x2="56" y2="72" />
  <line x1="57" y1="47" x2="57" y2="72" />
  <line x1="57" y1="47" x2="57" y2="72" />
  <line x1="57" y1="47" x2="57" y2="73" />
  <line x1="58" y1="48" x2="58" y2="73" />
  <line x1="58" y1="48" x2="58" y2="74" />
  <line x1="59" y1="49" x2="59" y2="74" />
  <line x1="59" y1="49" x2="59" y2="74" />
  <line x1="59" y1="49" x2="59" y2="75" />
  <line x1="60" y1="50" x2="60" y2="75" />
  <line x1="60" y1="50" x2="60" y2="76" />
  <line x1="61" y1="51" x2="61" y2="76" />
  <line x1="61" y1="51" x2="61" y2="76" />
  <line x1="61" y1="51" x2="61" y2="77" />
  <line x1="62" y1="52" x2="62" y2="77" />
  <line x1="62" y1="52" x2="62" y2="78" />
  <line x1="63" y1="53" x2="63" y2="78" />
  <line x1="63" y1="53" x2="63" y2="78" />
  <line x1="63" y1="53" x2="63" y2="79" />
  <line x1="64" y1="54" x2="64" y2="79" />
  <line x1="64" y1="54" x2="64" y2="80" />
  <line x1="65" y1="55" x2="65" y2="80" />
  <line x1="65" y1="55" x2="65" y2="80" />
  <line x1="65" y1="55" x2="65" y2="81" />
  <line x1="66" y1="56" x2="66" y2="81" />
  <line x1="66" y1="56" x2="66" y2="82" />
  <line x1="67" y1="57" x2="67" y2="82" />
  <line x1="67" y1="57" x2="67" y2="82" />
  <line x1="67" y1="57" x2="67" y2="83" />
  <line x1="68" y1="58" x2="68" y2="83" />
  <line x1="68" y1="58" x2="68" y2="84" />
  <line x1="69" y1="59" x2="69" y2="84" />
  <line x1="69" y1="59" x2="69" y2="85" />
  <line x1="70" y1="60" x2="70" y2="85" />
  <line x1="70" y1="60" x2="70" y2="85" />
  <line x1="70" y1="60" x2="70" y2="86" />
  <line x1="71" y1="61" x2="71" y2="86" />
  <line x1="71" y1="61" x2="71" y2="87" />
  <line x1="72" y1="62" x2="72" y2="87" />
  <line x1="72" y1="62" x2="72" y2="87" />
  <line x1="72" y1="62" x2="72" y2="88" />
  <line x1="73" y1="63" x2="73" y2="88" />
  <line x1="73" y1="63" x2="73" y2="89" />
  <line x1="74" y1="64" x2="74" y2="89" />
  <line x1="74" y1="64" x2="74" y2="89" />
  <line x1="74" y1="64" x2="74" y2="90" />
  <line x1="75" y1="65" x2="75" y2="90" />
  <line x1="75" y1="65" x2="75" y2="91" />
  <line x1="76" y1="66" x2="76" y2="91" />
  <line x1="76" y1="66" x2="76" y2="91" />
  <line x1="76" y1="66" x2="76" y2="92" />
  <line x1="77" y1="67" x2="77" y2="92" />
  <line x1="77" y1="67" x2="77" y2="93" />
  <line x1="78" y1="68" x2="78" y2="93" />
  <line x1="78" y1="68" x2="78" y2="93" />
  <line x1="78" y1="68" x2="78" y2="94" />
  <line x1="79" y1="69" x2="79" y2="94" />
  <line x1="79" y1="69" x2="79" y2="95" />
  <line x1="80" y1="70" x2="80" y2="95" />
  <line x1="80" y1="70" x2="80" y2="95" />
  <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.000000,0.000000 80.588235,70.588235 80.588235,96.000852 10.000000,25.412617" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="35" y2="0" />
  <line x1="10" y1="0" x2="36" y2="0" />
  <line x1="11" y1="1" x2="36" y2="1" />
  <line x1="11" y1="1" x2="37" y2="1" />
  <line x1="12" y1="2" x2="37" y2="2" />
  <line x1="12" y1="2" x2="37" y2="2" />
  <line x1="12" y1="2" x2="38" y2="2" />
  <line x1="13" y1="3" x2="38" y2="3" />
  <line x1="13" y1="3" x2="39" y2="3" />
  <line x1="14" y1="4" x2="39" y2="4" />
  <line x1="14" y1="4" x2="39" y2="4" />
  <line x1="14" y1="4" x2="40" y2="4" />
  <line x1="15" y1="5" x2="40" y2="5" />
  <line x1="15" y1="5" x2="41" y2="5" />
  <line x1="16" y1="6" x2="41" y2="6" />
  <line x1="16" y1="6" x2="41" y2="6" />
  <line x1="16" y1="6" x2="42" y2="6" />
  <line x1="17" y1="7" x2="42" y2="7" />
  <line x1="17" y1="7" x2="43" y2="7" />
  <line x1="18" y1="8" x2="43" y2="8" />
  <line x1="18" y1="8" x2="43" y2="8" />
  <line x1="18" y1="8" x2="44" y2="8" />
  <line x1="19" y1="9" x2="44" y2="9" />
  <line x1="19" y1="9" x2="45" y2="9" />
  <line x1="20" y1="10" x2="45" y2="10" />
  <line x1="20" y1="10" x2="45" y2="10" />
  <line x1="20" y1="10" x2="46" y2="10" />
  <line x1="21" y1="11" x2="46" y2="11" />
  <line x1="21" y1="11" x2="47" y2="11" />
  <line x1="22" y1="12" x2="47" y2="12" />
  <line x1="22" y1="12" x2="47" y2="12" />
  <line x1="22" y1="12" x2="48" y2="12" />
  <line x1="23" y1="13" x2="48" y2="13" />
  <line x1="23" y1="13" x2="49" y2="13" />
  <line x1="24" y1="14" x2="49" y2="14" />
  <line x1="24" y1="14" x2="50" y2="14" />
  <line x1="25" y1="15" x2="50" y2="15" />
  <line x1="25" y1="15" x2="50" y2="15" />
  <line x1="25" y1="15" x2="51" y2="15" />
  <line x1="26" y1="16" x2="51" y2="16" />
  <line x1="26" y1="16" x2="52" y2="16" />
  <line x1="27" y1="17" x2="52" y2="17" />
  <line x1="27" y1="17" x2="52" y2="17" />
  <line x1="27" y1="17" x2="53" y2="17" />
  <line x1="28" y1="18" x2="53" y2="18" />
  <line x1="28" y1="18" x2="54" y2="18" />
  <line x1="29" y1="19" x2="54" y2="19" />
  <line x1="29" y1="19" x2="54" y2="19" />
  <line x1="29" y1="19" x2="55" y2="19" />
  <line x1="30" y1="20" x2="55" y2="20" />
  <line x1="30" y1="20" x2="56" y2="20" />
  <line x1="31" y1="21" x2="56" y2="21" />
  <line x1="31" y1="21" x2="56" y2="21" />
  <line x1="31" y1="21" x2="57" y2="21" />
  <line x1="32" y1="22" x2="57" y2="22" />
  <line x1="32" y1="22" x2="58" y2="22" />
  <line x1="33" y1="23" x2="58" y2="23" />
  <line x1="33" y1="23" x2="58" y2="23" />
  <line x1="33" y1="23" x2="59" y2="23" />
  <line x1="34" y1="24" x2="59" y2="24" />
  <line x1="34" y1="24" x2="60" y2="24" />
  <line x1="35" y1="25" x2="60" y2="25" />
  <line x1="35" y1="25" x2="60" y2="25" />
  <line x1="35" y1="25" x2="61" y2="25" />
  <line x1="36" y1="26" x2="61" y2="26" />
  <line x1="36" y1="26" x2="62" y2="26" />
  <line x1="37" y1="27" x2="62" y2="27" />
  <line x1="37" y1="27" x2="62" y2="27" />
  <line x1="37" y1="27" x2="63" y2="27" />
  <line x1="38" y1="28" x2="63" y2="28" />
  <line x1="38" y1="28" x2="64" y2="28" />
  <line x1="39" y1="29" x2="64" y2="29" />
  <line x1="39" y1="29" x2="65" y2="29" />
  <line x1="40" y1="30" x2="65" y2="30" />
  <line x1="40" y1="30" x2="65" y2="30" />
  <line x1="40" y1="30" x2="66" y2="30" />
  <line x1="41" y1="31" x2="66" y2="31" />
  <line x1="41" y1="31" x2="67" y2="31" />
  <line x1="42" y1="32" x2="67" y2="32" />
  <line x1="42" y1="32" x2="67" y2="32" />
  <line x1="42" y1="32" x2="68" y2="32" />
  <line x1="43" y1="33" x2="68" y2="33" />
  <line x1="43" y1="33" x2="69" y2="33" />
  <line x1="44" y1="34" x2="69" y2="34" />
  <line x1="44" y1="34" x2="69" y2="34" />
  <line x1="44" y1="34" x2="70" y2="34" />
  <line x1="45" y1="35" x2="70" y2="35" />
  <line x1="45" y1="35" x2="71" y2="35" />
  <line x1="46" y1="36" x2="71" y2="36" />
  <line x1="46" y1="36" x2="71" y2="36" />
  <line x1="46" y1="36" x2="72" y2="36" />
  <line x1="47" y1="37" x2="72" y2="37" />
  <line x1="47" y1="37" x2="73" y2="37" />
  <line x1="48" y1="38" x2="73" y2="38" />
  <line x1="48" y1="38" x2="73" y2="38" />
  <line x1="48" y1="38" x2="74" y2="38" />
  <line x1="49" y1="39" x2="74" y2="39" />
  <line x1="49" y1="39" x2="75" y2="39" />
  <line x1="50" y1="40" x2="75" y2="40" />
  <line x1="50" y1="40" x2="75" y2="40" />
  <line x1="50" y1="40" x2="76" y2="40" />
  <line x1="51" y1="41" x2="76" y2="41" />
  <line x1="51" y1="41" x2="77" y2="41" />
  <line x1="52" y1="42" x2="77" y2="42" />
  <line x1="52" y1="42" x2="77" y2="42" />
  <line x1="52" y1="42" x2="78" y2="42" />
  <line x1="53" y1="43" x2="78" y2="43" />
  <line x1="53" y1="43" x2="79" y2="43" />
  <line x1="54" y1="44" x2="79" y2="44" />
  <line x1="54" y1="44" x2="80" y2="44" />
  <line x1="55" y1="45" x2="80" y2="45" />
  <line x1="55" y1="45" x2="80" y2="45" />
  <line x1="55" y1="45" x2="81" y2="45" />
  <line x1="56" y1="46" x2="81" y2="46" />
  <line x1="56" y1="46" x2="82" y2="46" />
  <line x1="57" y1="47" x2="82" y2="47" />
  <line x1="57" y1="47" x2="82" y2="47" />
  <line x1="57" y1="47" x2="83" y2="47" />
  <line x1="58" y1="48" x2="83" y2="48" />
  <line x1="58" y1="48" x2="84" y2="48" />
  <line x1="59" y1="49" x2="84" y2="49" />
  <line x1="59" y1="49" x2="84" y2="49" />
  <line x1="59" y1="49" x2="85" y2="49" />
  <line x1="60" y1="50" x2="85" y2="50" />
  <line x1="60" y1="50" x2="86" y2="50" />
  <line x1="61" y1="51" x2="86" y2="51" />
  <line x1="61" y1="51" x2="86" y2="51" />
  <line x1="61" y1="51" x2="87" y2="51" />
  <line x1="62" y1="52" x2="87" y2="52" />
  <line x1="62" y1="52" x2="88" y2="52" />
  <line x1="63" y1="53" x2="88" y2="53" />
  <line x1="63" y1="53" x2="88" y2="53" />
  <line x1="63" y1="53" x2="89" y2="53" />
  <line x1="64" y1="54" x2="89" y2="54" />
  <line x1="64" y1="54" x2="90" y2="54" />
  <line x1="65" y1="55" x2="90" y2="55" />
  <line x1="65" y1="55" x2="90" y2="55" />
  <line x1="65" y1="55" x2="91" y2="55" />
  <line x1="66" y1="56" x2="91" y2="56" />
  <line x1="66" y1="56" x2="92" y2="56" />
  <line x1="67" y1="57" x2="92" y2="57" />
  <line x1="67" y1="57" x2="92" y2="57" />
  <line x1="67" y1="57" x2="93" y2="57" />
  <line x1="68" y1="58" x2="93" y2="58" />
  <line x1="68" y1="58" x2="94" y2="58" />
  <line x1="69" y1="59" x2="94" y2="59" />
  <line x1="69" y1="59" x2="95" y2="59" />
  <line x1="70" y1="60" x2="95" y2="60" />
  <line x1="70" y1="60" x2="95" y2="60" />
  <line x1="70" y1="60" x2="96" y2="60" />
  <line x1="71" y1="61" x2="96" y2="61" />
  <line x1="71" y1="61" x2="97" y2="61" />
  <line x1="72" y1="62" x2="97" y2="62" />
  <line x1="72" y1="62" x2="97" y2="62" />
  <line x1="72" y1="62" x2="98" y2="62" />
  <line x1="73" y1="63" x2="98" y2="63" />
  <line x1="73" y1="63" x2="99" y2="63" />
  <line x1="74" y1="64" x2="99" y2="64" />
  <line x1="74" y1="64" x2="99" y2="64" />
  <line x1="74" y1="64" x2="100" y2="64" />
  <line x1="75" y1="65" x2="100" y2="65" />
  <line x1="75" y1="65" x2="101" y2="65" />
  <line x1="76" y1="66" x2="101" y2="66" />
  <line x1="76" y1="66" x2="101" y2="66" />
  <line x1="76" y1="66" x2="102" y2="66" />
  <line x1="77" y1="67" x2="102" y2="67" />
  <line x1="77" y1="67" x2="103" y2="67" />
  <line x1="78" y1="68" x2="103" y2="68" />
  <line x1="78" y1="68" x2="103" y2="68" />
  <line x1="78" y1="68" x2="104" y2="68" />
  <line x1="79" y1="69" x2="104" y2="69" />
  <line x1="79" y1="69" x2="105" y2="69" />
  <line x1="80" y1="70" x2="105" y2="70" />
  <line x1="80" y1="70" x2="105" y2="70" />
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.000000,0.000000 35.412617,0.000000 106.000852,70.588235 80.588235,70.588235" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2" />
  <line x1="80" y1="71" x2="106" y2="71" />
  <line x1="80" y1="71" x2="106" y2="71" />
  <line x1="80" y1="71" x2="106" y2="71" />
  <line x1="80" y1="72" x2="106" y2="72" />
  <line x1="80" y1="72" x2="106" y2="72" />
  <line x1="80" y1="72" x2="106" y2="72" />
  <line x1="80" y1="73" x2="106" y2="73" />
  <line x1="80" y1="73" x2="106" y2="73" />
  <line x1="80" y1="73" x2="106" y2="73" />
  <line x1="80" y1="74" x2="106" y2="74" />
  <line x1="80" y1="74" x2="106" y2="74" />
  <line x1="80" y1="74" x2="106" y2="74" />
  <line x1="80" y1="75" x2="106" y2="75" />
  <line x1="80" y1="75" x2="106" y2="75" />
  <line x1="80" y1="75" x2="106" y2="75" />
  <line x1="80" y1="76" x2="106" y2="76" />
  <line x1="80" y1="76" x2="106" y2="76" />
  <line x1="80" y1="77" x2="106" y2="77" />
  <line x1="80" y1="77" x2="106" y2="77" />
  <line x1="80" y1="77" x2="106" y2="77" />
  <line x1="80" y1="78" x2="106" y2="78" />
  <line x1="80" y1="78" x2="106" y2="78" />
  <line x1="80" y1="78" x2="106" y2="78" />
  <line x1="80" y1="79" x2="106" y2="79" />
  <line x1="80" y1="79" x2="106" y2="79" />
  <line x1="80" y1="80" x2="106" y2="80" />
  <line x1="80" y1="80" x2="106" y2="80" />
  <line x1="80" y1="80" x2="106" y2="80" />
  <line x1="80" y1="81" x2="106" y2="81" />
  <line x1="80" y1="81" x2="106" y2="81" />
  <line x1="80" y1="81" x2="106" y2="81" />
  <line x1="80" y1="82" x2="106" y2="82" />
  <line x1="80" y1="82" x2="106" y2="82" />
  <line x1="80" y1="82" x2="106" y2="82" />
  <line x1="80" y1="83" x2="106" y2="83" />
  <line x1="80" y1="83" x2="106" y2="83" />
  <line x1="80" y1="84" x2="106" y2="84" />
  <line x1="80" y1="84" x2="106" y2="84" />
  <line x1="80" y1="84" x2="106" y2="84" />
  <line x1="80" y1="85" x2="106" y2="85" />
  <line x1="80" y1="85" x2="106" y2="85" />
  <line x1="80" y1="86" x2="106" y2="86" />
  <line x1="80" y1="86" x2="106" y2="86" />
  <line x1="80" y1="86" x2="106" y2="86" />
  <line x1="80" y1="87" x2="106" y2="87" />
  <line x1="80" y1="87" x2="106" y2="87" />
  <line x1="80" y1="87" x2="106" y2="87" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="89" x2="106" y2="89" />
  <line x1="80" y1="89" x2="106" y2="89" />
  <line x1="80" y1="89" x2="106" y2="89" />
  <line x1="80" y1="90" x2="106" y2="90" />
  <line x1="80" y1="90" x2="106" y2="90" />
  <line x1="80" y1="91" x2="106" y2="91" />
  <line x1="80" y1="91" x2="106" y2="91" />
  <line x1="80" y1="91" x2="106" y2="91" />
  <line x1="80" y1="92" x2="106" y2="92" />
  <line x1="80" y1="92" x2="106" y2="92" />
  <line x1="80" y1="93" x2="106" y2="93" />
  <line x1="80" y1="93" x2="106" y2="93" />
  <line x1="80" y1="94" x2="106" y2="94" />
  <line x1="80" y1="94" x2="106" y2="94" />
  <line x1="80" y1="95" x2="106" y2="95" />
  <line x1="80" y1="95" x2="106" y2="95" />
  <line x1="80" y1="96" x2="106" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2" />
  <line x1="106" y1="70" x2="106" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.588235,70.588235 106.000852,70.588235 106.000852,96.000852 80.588235,96.000852" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.294544" y="116.000852" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="126.000852" y="83.294544" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.000852,83.294544)">2784</text>
  <text x="35.294118" y="80.706734" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,80.706734)">52226568</text>
</svg>
</td>
</tr>
</table></div></div>
</div>
<p>Note that the columns of this array (second dimension) match the rows in the sample metadata, if the same sample sets were loaded. I.e.:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contig</span> <span class="o">=</span> <span class="s1">&#39;3R&#39;</span>
<span class="n">df_samples</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">sample_metadata</span><span class="p">(</span><span class="n">sample_sets</span><span class="o">=</span><span class="s2">&quot;v3_wild&quot;</span><span class="p">)</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">snp_genotypes</span><span class="p">(</span><span class="n">contig</span><span class="o">=</span><span class="n">contig</span><span class="p">,</span> <span class="n">sample_sets</span><span class="o">=</span><span class="s2">&quot;v3_wild&quot;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df_samples</span><span class="p">)</span> <span class="o">==</span> <span class="n">gt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>You can use this correspondance to apply further subsetting operations to the genotypes by querying the sample metadata. E.g.:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dask.array</span> <span class="k">as</span> <span class="nn">da</span>
<span class="n">loc_gambiae</span> <span class="o">=</span> <span class="n">df_samples</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;species == &#39;gambiae&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">loc_gambiae</span><span class="p">)</span><span class="si">}</span><span class="s2"> gambiae samples&quot;</span><span class="p">)</span>
<span class="n">gt_gambiae</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">gt</span><span class="p">,</span> <span class="n">loc_gambiae</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">gt_gambiae</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>found 1571 gambiae samples
</pre></div>
</div>
<div class="output text_html"><table>
<tr>
<td>
<table>
  <thead>
    <tr><td> </td><th> Array </th><th> Chunk </th></tr>
  </thead>
  <tbody>
    <tr><th> Bytes </th><td> 164.10 GB </td> <td> 30.00 MB </td></tr>
    <tr><th> Shape </th><td> (52226568, 1571, 2) </td> <td> (300000, 50, 2) </td></tr>
    <tr><th> Count </th><td> 33627 Tasks </td><td> 9800 Chunks </td></tr>
    <tr><th> Type </th><td> int8 </td><td> numpy.ndarray </td></tr>
  </tbody>
</table>
</td>
<td>
<svg width="156" height="146" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="0" x2="80" y2="70" />
  <line x1="10" y1="0" x2="80" y2="71" />
  <line x1="10" y1="1" x2="80" y2="71" />
  <line x1="10" y1="1" x2="80" y2="72" />
  <line x1="10" y1="1" x2="80" y2="72" />
  <line x1="10" y1="2" x2="80" y2="72" />
  <line x1="10" y1="2" x2="80" y2="72" />
  <line x1="10" y1="2" x2="80" y2="73" />
  <line x1="10" y1="3" x2="80" y2="73" />
  <line x1="10" y1="3" x2="80" y2="74" />
  <line x1="10" y1="4" x2="80" y2="74" />
  <line x1="10" y1="4" x2="80" y2="75" />
  <line x1="10" y1="5" x2="80" y2="76" />
  <line x1="10" y1="6" x2="80" y2="76" />
  <line x1="10" y1="7" x2="80" y2="77" />
  <line x1="10" y1="7" x2="80" y2="78" />
  <line x1="10" y1="8" x2="80" y2="79" />
  <line x1="10" y1="9" x2="80" y2="80" />
  <line x1="10" y1="9" x2="80" y2="80" />
  <line x1="10" y1="10" x2="80" y2="80" />
  <line x1="10" y1="11" x2="80" y2="81" />
  <line x1="10" y1="11" x2="80" y2="81" />
  <line x1="10" y1="11" x2="80" y2="82" />
  <line x1="10" y1="12" x2="80" y2="83" />
  <line x1="10" y1="12" x2="80" y2="83" />
  <line x1="10" y1="13" x2="80" y2="83" />
  <line x1="10" y1="13" x2="80" y2="84" />
  <line x1="10" y1="14" x2="80" y2="84" />
  <line x1="10" y1="14" x2="80" y2="84" />
  <line x1="10" y1="14" x2="80" y2="85" />
  <line x1="10" y1="14" x2="80" y2="85" />
  <line x1="10" y1="15" x2="80" y2="85" />
  <line x1="10" y1="15" x2="80" y2="86" />
  <line x1="10" y1="16" x2="80" y2="87" />
  <line x1="10" y1="17" x2="80" y2="88" />
  <line x1="10" y1="17" x2="80" y2="88" />
  <line x1="10" y1="17" x2="80" y2="88" />
  <line x1="10" y1="17" x2="80" y2="88" />
  <line x1="10" y1="18" x2="80" y2="88" />
  <line x1="10" y1="18" x2="80" y2="88" />
  <line x1="10" y1="18" x2="80" y2="89" />
  <line x1="10" y1="19" x2="80" y2="89" />
  <line x1="10" y1="19" x2="80" y2="89" />
  <line x1="10" y1="19" x2="80" y2="90" />
  <line x1="10" y1="19" x2="80" y2="90" />
  <line x1="10" y1="20" x2="80" y2="91" />
  <line x1="10" y1="20" x2="80" y2="91" />
  <line x1="10" y1="21" x2="80" y2="91" />
  <line x1="10" y1="21" x2="80" y2="91" />
  <line x1="10" y1="21" x2="80" y2="92" />
  <line x1="10" y1="22" x2="80" y2="92" />
  <line x1="10" y1="22" x2="80" y2="92" />
  <line x1="10" y1="23" x2="80" y2="93" />
  <line x1="10" y1="23" x2="80" y2="94" />
  <line x1="10" y1="24" x2="80" y2="95" />
  <line x1="10" y1="25" x2="80" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="25" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="10" y1="0" x2="10" y2="26" />
  <line x1="11" y1="1" x2="11" y2="26" />
  <line x1="11" y1="1" x2="11" y2="27" />
  <line x1="12" y1="2" x2="12" y2="27" />
  <line x1="12" y1="2" x2="12" y2="27" />
  <line x1="12" y1="2" x2="12" y2="28" />
  <line x1="13" y1="3" x2="13" y2="28" />
  <line x1="13" y1="3" x2="13" y2="29" />
  <line x1="14" y1="4" x2="14" y2="29" />
  <line x1="14" y1="4" x2="14" y2="29" />
  <line x1="14" y1="4" x2="14" y2="30" />
  <line x1="15" y1="5" x2="15" y2="30" />
  <line x1="15" y1="5" x2="15" y2="31" />
  <line x1="16" y1="6" x2="16" y2="31" />
  <line x1="16" y1="6" x2="16" y2="31" />
  <line x1="16" y1="6" x2="16" y2="32" />
  <line x1="17" y1="7" x2="17" y2="32" />
  <line x1="17" y1="7" x2="17" y2="33" />
  <line x1="18" y1="8" x2="18" y2="33" />
  <line x1="18" y1="8" x2="18" y2="33" />
  <line x1="18" y1="8" x2="18" y2="34" />
  <line x1="19" y1="9" x2="19" y2="34" />
  <line x1="19" y1="9" x2="19" y2="35" />
  <line x1="20" y1="10" x2="20" y2="35" />
  <line x1="20" y1="10" x2="20" y2="35" />
  <line x1="20" y1="10" x2="20" y2="36" />
  <line x1="21" y1="11" x2="21" y2="36" />
  <line x1="21" y1="11" x2="21" y2="37" />
  <line x1="22" y1="12" x2="22" y2="37" />
  <line x1="22" y1="12" x2="22" y2="37" />
  <line x1="22" y1="12" x2="22" y2="38" />
  <line x1="23" y1="13" x2="23" y2="38" />
  <line x1="23" y1="13" x2="23" y2="39" />
  <line x1="24" y1="14" x2="24" y2="39" />
  <line x1="24" y1="14" x2="24" y2="40" />
  <line x1="25" y1="15" x2="25" y2="40" />
  <line x1="25" y1="15" x2="25" y2="40" />
  <line x1="25" y1="15" x2="25" y2="41" />
  <line x1="26" y1="16" x2="26" y2="41" />
  <line x1="26" y1="16" x2="26" y2="42" />
  <line x1="27" y1="17" x2="27" y2="42" />
  <line x1="27" y1="17" x2="27" y2="42" />
  <line x1="27" y1="17" x2="27" y2="43" />
  <line x1="28" y1="18" x2="28" y2="43" />
  <line x1="28" y1="18" x2="28" y2="44" />
  <line x1="29" y1="19" x2="29" y2="44" />
  <line x1="29" y1="19" x2="29" y2="44" />
  <line x1="29" y1="19" x2="29" y2="45" />
  <line x1="30" y1="20" x2="30" y2="45" />
  <line x1="30" y1="20" x2="30" y2="46" />
  <line x1="31" y1="21" x2="31" y2="46" />
  <line x1="31" y1="21" x2="31" y2="46" />
  <line x1="31" y1="21" x2="31" y2="47" />
  <line x1="32" y1="22" x2="32" y2="47" />
  <line x1="32" y1="22" x2="32" y2="48" />
  <line x1="33" y1="23" x2="33" y2="48" />
  <line x1="33" y1="23" x2="33" y2="48" />
  <line x1="33" y1="23" x2="33" y2="49" />
  <line x1="34" y1="24" x2="34" y2="49" />
  <line x1="34" y1="24" x2="34" y2="50" />
  <line x1="35" y1="25" x2="35" y2="50" />
  <line x1="35" y1="25" x2="35" y2="50" />
  <line x1="35" y1="25" x2="35" y2="51" />
  <line x1="36" y1="26" x2="36" y2="51" />
  <line x1="36" y1="26" x2="36" y2="52" />
  <line x1="37" y1="27" x2="37" y2="52" />
  <line x1="37" y1="27" x2="37" y2="52" />
  <line x1="37" y1="27" x2="37" y2="53" />
  <line x1="38" y1="28" x2="38" y2="53" />
  <line x1="38" y1="28" x2="38" y2="54" />
  <line x1="39" y1="29" x2="39" y2="54" />
  <line x1="39" y1="29" x2="39" y2="55" />
  <line x1="40" y1="30" x2="40" y2="55" />
  <line x1="40" y1="30" x2="40" y2="55" />
  <line x1="40" y1="30" x2="40" y2="56" />
  <line x1="41" y1="31" x2="41" y2="56" />
  <line x1="41" y1="31" x2="41" y2="57" />
  <line x1="42" y1="32" x2="42" y2="57" />
  <line x1="42" y1="32" x2="42" y2="57" />
  <line x1="42" y1="32" x2="42" y2="58" />
  <line x1="43" y1="33" x2="43" y2="58" />
  <line x1="43" y1="33" x2="43" y2="59" />
  <line x1="44" y1="34" x2="44" y2="59" />
  <line x1="44" y1="34" x2="44" y2="59" />
  <line x1="44" y1="34" x2="44" y2="60" />
  <line x1="45" y1="35" x2="45" y2="60" />
  <line x1="45" y1="35" x2="45" y2="61" />
  <line x1="46" y1="36" x2="46" y2="61" />
  <line x1="46" y1="36" x2="46" y2="61" />
  <line x1="46" y1="36" x2="46" y2="62" />
  <line x1="47" y1="37" x2="47" y2="62" />
  <line x1="47" y1="37" x2="47" y2="63" />
  <line x1="48" y1="38" x2="48" y2="63" />
  <line x1="48" y1="38" x2="48" y2="63" />
  <line x1="48" y1="38" x2="48" y2="64" />
  <line x1="49" y1="39" x2="49" y2="64" />
  <line x1="49" y1="39" x2="49" y2="65" />
  <line x1="50" y1="40" x2="50" y2="65" />
  <line x1="50" y1="40" x2="50" y2="65" />
  <line x1="50" y1="40" x2="50" y2="66" />
  <line x1="51" y1="41" x2="51" y2="66" />
  <line x1="51" y1="41" x2="51" y2="67" />
  <line x1="52" y1="42" x2="52" y2="67" />
  <line x1="52" y1="42" x2="52" y2="67" />
  <line x1="52" y1="42" x2="52" y2="68" />
  <line x1="53" y1="43" x2="53" y2="68" />
  <line x1="53" y1="43" x2="53" y2="69" />
  <line x1="54" y1="44" x2="54" y2="69" />
  <line x1="54" y1="44" x2="54" y2="70" />
  <line x1="55" y1="45" x2="55" y2="70" />
  <line x1="55" y1="45" x2="55" y2="70" />
  <line x1="55" y1="45" x2="55" y2="71" />
  <line x1="56" y1="46" x2="56" y2="71" />
  <line x1="56" y1="46" x2="56" y2="72" />
  <line x1="57" y1="47" x2="57" y2="72" />
  <line x1="57" y1="47" x2="57" y2="72" />
  <line x1="57" y1="47" x2="57" y2="73" />
  <line x1="58" y1="48" x2="58" y2="73" />
  <line x1="58" y1="48" x2="58" y2="74" />
  <line x1="59" y1="49" x2="59" y2="74" />
  <line x1="59" y1="49" x2="59" y2="74" />
  <line x1="59" y1="49" x2="59" y2="75" />
  <line x1="60" y1="50" x2="60" y2="75" />
  <line x1="60" y1="50" x2="60" y2="76" />
  <line x1="61" y1="51" x2="61" y2="76" />
  <line x1="61" y1="51" x2="61" y2="76" />
  <line x1="61" y1="51" x2="61" y2="77" />
  <line x1="62" y1="52" x2="62" y2="77" />
  <line x1="62" y1="52" x2="62" y2="78" />
  <line x1="63" y1="53" x2="63" y2="78" />
  <line x1="63" y1="53" x2="63" y2="78" />
  <line x1="63" y1="53" x2="63" y2="79" />
  <line x1="64" y1="54" x2="64" y2="79" />
  <line x1="64" y1="54" x2="64" y2="80" />
  <line x1="65" y1="55" x2="65" y2="80" />
  <line x1="65" y1="55" x2="65" y2="80" />
  <line x1="65" y1="55" x2="65" y2="81" />
  <line x1="66" y1="56" x2="66" y2="81" />
  <line x1="66" y1="56" x2="66" y2="82" />
  <line x1="67" y1="57" x2="67" y2="82" />
  <line x1="67" y1="57" x2="67" y2="82" />
  <line x1="67" y1="57" x2="67" y2="83" />
  <line x1="68" y1="58" x2="68" y2="83" />
  <line x1="68" y1="58" x2="68" y2="84" />
  <line x1="69" y1="59" x2="69" y2="84" />
  <line x1="69" y1="59" x2="69" y2="85" />
  <line x1="70" y1="60" x2="70" y2="85" />
  <line x1="70" y1="60" x2="70" y2="85" />
  <line x1="70" y1="60" x2="70" y2="86" />
  <line x1="71" y1="61" x2="71" y2="86" />
  <line x1="71" y1="61" x2="71" y2="87" />
  <line x1="72" y1="62" x2="72" y2="87" />
  <line x1="72" y1="62" x2="72" y2="87" />
  <line x1="72" y1="62" x2="72" y2="88" />
  <line x1="73" y1="63" x2="73" y2="88" />
  <line x1="73" y1="63" x2="73" y2="89" />
  <line x1="74" y1="64" x2="74" y2="89" />
  <line x1="74" y1="64" x2="74" y2="89" />
  <line x1="74" y1="64" x2="74" y2="90" />
  <line x1="75" y1="65" x2="75" y2="90" />
  <line x1="75" y1="65" x2="75" y2="91" />
  <line x1="76" y1="66" x2="76" y2="91" />
  <line x1="76" y1="66" x2="76" y2="91" />
  <line x1="76" y1="66" x2="76" y2="92" />
  <line x1="77" y1="67" x2="77" y2="92" />
  <line x1="77" y1="67" x2="77" y2="93" />
  <line x1="78" y1="68" x2="78" y2="93" />
  <line x1="78" y1="68" x2="78" y2="93" />
  <line x1="78" y1="68" x2="78" y2="94" />
  <line x1="79" y1="69" x2="79" y2="94" />
  <line x1="79" y1="69" x2="79" y2="95" />
  <line x1="80" y1="70" x2="80" y2="95" />
  <line x1="80" y1="70" x2="80" y2="95" />
  <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.000000,0.000000 80.588235,70.588235 80.588235,96.000852 10.000000,25.412617" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="35" y2="0" />
  <line x1="10" y1="0" x2="36" y2="0" />
  <line x1="11" y1="1" x2="36" y2="1" />
  <line x1="11" y1="1" x2="37" y2="1" />
  <line x1="12" y1="2" x2="37" y2="2" />
  <line x1="12" y1="2" x2="37" y2="2" />
  <line x1="12" y1="2" x2="38" y2="2" />
  <line x1="13" y1="3" x2="38" y2="3" />
  <line x1="13" y1="3" x2="39" y2="3" />
  <line x1="14" y1="4" x2="39" y2="4" />
  <line x1="14" y1="4" x2="39" y2="4" />
  <line x1="14" y1="4" x2="40" y2="4" />
  <line x1="15" y1="5" x2="40" y2="5" />
  <line x1="15" y1="5" x2="41" y2="5" />
  <line x1="16" y1="6" x2="41" y2="6" />
  <line x1="16" y1="6" x2="41" y2="6" />
  <line x1="16" y1="6" x2="42" y2="6" />
  <line x1="17" y1="7" x2="42" y2="7" />
  <line x1="17" y1="7" x2="43" y2="7" />
  <line x1="18" y1="8" x2="43" y2="8" />
  <line x1="18" y1="8" x2="43" y2="8" />
  <line x1="18" y1="8" x2="44" y2="8" />
  <line x1="19" y1="9" x2="44" y2="9" />
  <line x1="19" y1="9" x2="45" y2="9" />
  <line x1="20" y1="10" x2="45" y2="10" />
  <line x1="20" y1="10" x2="45" y2="10" />
  <line x1="20" y1="10" x2="46" y2="10" />
  <line x1="21" y1="11" x2="46" y2="11" />
  <line x1="21" y1="11" x2="47" y2="11" />
  <line x1="22" y1="12" x2="47" y2="12" />
  <line x1="22" y1="12" x2="47" y2="12" />
  <line x1="22" y1="12" x2="48" y2="12" />
  <line x1="23" y1="13" x2="48" y2="13" />
  <line x1="23" y1="13" x2="49" y2="13" />
  <line x1="24" y1="14" x2="49" y2="14" />
  <line x1="24" y1="14" x2="50" y2="14" />
  <line x1="25" y1="15" x2="50" y2="15" />
  <line x1="25" y1="15" x2="50" y2="15" />
  <line x1="25" y1="15" x2="51" y2="15" />
  <line x1="26" y1="16" x2="51" y2="16" />
  <line x1="26" y1="16" x2="52" y2="16" />
  <line x1="27" y1="17" x2="52" y2="17" />
  <line x1="27" y1="17" x2="52" y2="17" />
  <line x1="27" y1="17" x2="53" y2="17" />
  <line x1="28" y1="18" x2="53" y2="18" />
  <line x1="28" y1="18" x2="54" y2="18" />
  <line x1="29" y1="19" x2="54" y2="19" />
  <line x1="29" y1="19" x2="54" y2="19" />
  <line x1="29" y1="19" x2="55" y2="19" />
  <line x1="30" y1="20" x2="55" y2="20" />
  <line x1="30" y1="20" x2="56" y2="20" />
  <line x1="31" y1="21" x2="56" y2="21" />
  <line x1="31" y1="21" x2="56" y2="21" />
  <line x1="31" y1="21" x2="57" y2="21" />
  <line x1="32" y1="22" x2="57" y2="22" />
  <line x1="32" y1="22" x2="58" y2="22" />
  <line x1="33" y1="23" x2="58" y2="23" />
  <line x1="33" y1="23" x2="58" y2="23" />
  <line x1="33" y1="23" x2="59" y2="23" />
  <line x1="34" y1="24" x2="59" y2="24" />
  <line x1="34" y1="24" x2="60" y2="24" />
  <line x1="35" y1="25" x2="60" y2="25" />
  <line x1="35" y1="25" x2="60" y2="25" />
  <line x1="35" y1="25" x2="61" y2="25" />
  <line x1="36" y1="26" x2="61" y2="26" />
  <line x1="36" y1="26" x2="62" y2="26" />
  <line x1="37" y1="27" x2="62" y2="27" />
  <line x1="37" y1="27" x2="62" y2="27" />
  <line x1="37" y1="27" x2="63" y2="27" />
  <line x1="38" y1="28" x2="63" y2="28" />
  <line x1="38" y1="28" x2="64" y2="28" />
  <line x1="39" y1="29" x2="64" y2="29" />
  <line x1="39" y1="29" x2="65" y2="29" />
  <line x1="40" y1="30" x2="65" y2="30" />
  <line x1="40" y1="30" x2="65" y2="30" />
  <line x1="40" y1="30" x2="66" y2="30" />
  <line x1="41" y1="31" x2="66" y2="31" />
  <line x1="41" y1="31" x2="67" y2="31" />
  <line x1="42" y1="32" x2="67" y2="32" />
  <line x1="42" y1="32" x2="67" y2="32" />
  <line x1="42" y1="32" x2="68" y2="32" />
  <line x1="43" y1="33" x2="68" y2="33" />
  <line x1="43" y1="33" x2="69" y2="33" />
  <line x1="44" y1="34" x2="69" y2="34" />
  <line x1="44" y1="34" x2="69" y2="34" />
  <line x1="44" y1="34" x2="70" y2="34" />
  <line x1="45" y1="35" x2="70" y2="35" />
  <line x1="45" y1="35" x2="71" y2="35" />
  <line x1="46" y1="36" x2="71" y2="36" />
  <line x1="46" y1="36" x2="71" y2="36" />
  <line x1="46" y1="36" x2="72" y2="36" />
  <line x1="47" y1="37" x2="72" y2="37" />
  <line x1="47" y1="37" x2="73" y2="37" />
  <line x1="48" y1="38" x2="73" y2="38" />
  <line x1="48" y1="38" x2="73" y2="38" />
  <line x1="48" y1="38" x2="74" y2="38" />
  <line x1="49" y1="39" x2="74" y2="39" />
  <line x1="49" y1="39" x2="75" y2="39" />
  <line x1="50" y1="40" x2="75" y2="40" />
  <line x1="50" y1="40" x2="75" y2="40" />
  <line x1="50" y1="40" x2="76" y2="40" />
  <line x1="51" y1="41" x2="76" y2="41" />
  <line x1="51" y1="41" x2="77" y2="41" />
  <line x1="52" y1="42" x2="77" y2="42" />
  <line x1="52" y1="42" x2="77" y2="42" />
  <line x1="52" y1="42" x2="78" y2="42" />
  <line x1="53" y1="43" x2="78" y2="43" />
  <line x1="53" y1="43" x2="79" y2="43" />
  <line x1="54" y1="44" x2="79" y2="44" />
  <line x1="54" y1="44" x2="80" y2="44" />
  <line x1="55" y1="45" x2="80" y2="45" />
  <line x1="55" y1="45" x2="80" y2="45" />
  <line x1="55" y1="45" x2="81" y2="45" />
  <line x1="56" y1="46" x2="81" y2="46" />
  <line x1="56" y1="46" x2="82" y2="46" />
  <line x1="57" y1="47" x2="82" y2="47" />
  <line x1="57" y1="47" x2="82" y2="47" />
  <line x1="57" y1="47" x2="83" y2="47" />
  <line x1="58" y1="48" x2="83" y2="48" />
  <line x1="58" y1="48" x2="84" y2="48" />
  <line x1="59" y1="49" x2="84" y2="49" />
  <line x1="59" y1="49" x2="84" y2="49" />
  <line x1="59" y1="49" x2="85" y2="49" />
  <line x1="60" y1="50" x2="85" y2="50" />
  <line x1="60" y1="50" x2="86" y2="50" />
  <line x1="61" y1="51" x2="86" y2="51" />
  <line x1="61" y1="51" x2="86" y2="51" />
  <line x1="61" y1="51" x2="87" y2="51" />
  <line x1="62" y1="52" x2="87" y2="52" />
  <line x1="62" y1="52" x2="88" y2="52" />
  <line x1="63" y1="53" x2="88" y2="53" />
  <line x1="63" y1="53" x2="88" y2="53" />
  <line x1="63" y1="53" x2="89" y2="53" />
  <line x1="64" y1="54" x2="89" y2="54" />
  <line x1="64" y1="54" x2="90" y2="54" />
  <line x1="65" y1="55" x2="90" y2="55" />
  <line x1="65" y1="55" x2="90" y2="55" />
  <line x1="65" y1="55" x2="91" y2="55" />
  <line x1="66" y1="56" x2="91" y2="56" />
  <line x1="66" y1="56" x2="92" y2="56" />
  <line x1="67" y1="57" x2="92" y2="57" />
  <line x1="67" y1="57" x2="92" y2="57" />
  <line x1="67" y1="57" x2="93" y2="57" />
  <line x1="68" y1="58" x2="93" y2="58" />
  <line x1="68" y1="58" x2="94" y2="58" />
  <line x1="69" y1="59" x2="94" y2="59" />
  <line x1="69" y1="59" x2="95" y2="59" />
  <line x1="70" y1="60" x2="95" y2="60" />
  <line x1="70" y1="60" x2="95" y2="60" />
  <line x1="70" y1="60" x2="96" y2="60" />
  <line x1="71" y1="61" x2="96" y2="61" />
  <line x1="71" y1="61" x2="97" y2="61" />
  <line x1="72" y1="62" x2="97" y2="62" />
  <line x1="72" y1="62" x2="97" y2="62" />
  <line x1="72" y1="62" x2="98" y2="62" />
  <line x1="73" y1="63" x2="98" y2="63" />
  <line x1="73" y1="63" x2="99" y2="63" />
  <line x1="74" y1="64" x2="99" y2="64" />
  <line x1="74" y1="64" x2="99" y2="64" />
  <line x1="74" y1="64" x2="100" y2="64" />
  <line x1="75" y1="65" x2="100" y2="65" />
  <line x1="75" y1="65" x2="101" y2="65" />
  <line x1="76" y1="66" x2="101" y2="66" />
  <line x1="76" y1="66" x2="101" y2="66" />
  <line x1="76" y1="66" x2="102" y2="66" />
  <line x1="77" y1="67" x2="102" y2="67" />
  <line x1="77" y1="67" x2="103" y2="67" />
  <line x1="78" y1="68" x2="103" y2="68" />
  <line x1="78" y1="68" x2="103" y2="68" />
  <line x1="78" y1="68" x2="104" y2="68" />
  <line x1="79" y1="69" x2="104" y2="69" />
  <line x1="79" y1="69" x2="105" y2="69" />
  <line x1="80" y1="70" x2="105" y2="70" />
  <line x1="80" y1="70" x2="105" y2="70" />
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.000000,0.000000 35.412617,0.000000 106.000852,70.588235 80.588235,70.588235" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2" />
  <line x1="80" y1="70" x2="106" y2="70" />
  <line x1="80" y1="71" x2="106" y2="71" />
  <line x1="80" y1="71" x2="106" y2="71" />
  <line x1="80" y1="72" x2="106" y2="72" />
  <line x1="80" y1="72" x2="106" y2="72" />
  <line x1="80" y1="72" x2="106" y2="72" />
  <line x1="80" y1="72" x2="106" y2="72" />
  <line x1="80" y1="73" x2="106" y2="73" />
  <line x1="80" y1="73" x2="106" y2="73" />
  <line x1="80" y1="74" x2="106" y2="74" />
  <line x1="80" y1="74" x2="106" y2="74" />
  <line x1="80" y1="75" x2="106" y2="75" />
  <line x1="80" y1="76" x2="106" y2="76" />
  <line x1="80" y1="76" x2="106" y2="76" />
  <line x1="80" y1="77" x2="106" y2="77" />
  <line x1="80" y1="78" x2="106" y2="78" />
  <line x1="80" y1="79" x2="106" y2="79" />
  <line x1="80" y1="80" x2="106" y2="80" />
  <line x1="80" y1="80" x2="106" y2="80" />
  <line x1="80" y1="80" x2="106" y2="80" />
  <line x1="80" y1="81" x2="106" y2="81" />
  <line x1="80" y1="81" x2="106" y2="81" />
  <line x1="80" y1="82" x2="106" y2="82" />
  <line x1="80" y1="83" x2="106" y2="83" />
  <line x1="80" y1="83" x2="106" y2="83" />
  <line x1="80" y1="83" x2="106" y2="83" />
  <line x1="80" y1="84" x2="106" y2="84" />
  <line x1="80" y1="84" x2="106" y2="84" />
  <line x1="80" y1="84" x2="106" y2="84" />
  <line x1="80" y1="85" x2="106" y2="85" />
  <line x1="80" y1="85" x2="106" y2="85" />
  <line x1="80" y1="85" x2="106" y2="85" />
  <line x1="80" y1="86" x2="106" y2="86" />
  <line x1="80" y1="87" x2="106" y2="87" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="88" x2="106" y2="88" />
  <line x1="80" y1="89" x2="106" y2="89" />
  <line x1="80" y1="89" x2="106" y2="89" />
  <line x1="80" y1="89" x2="106" y2="89" />
  <line x1="80" y1="90" x2="106" y2="90" />
  <line x1="80" y1="90" x2="106" y2="90" />
  <line x1="80" y1="91" x2="106" y2="91" />
  <line x1="80" y1="91" x2="106" y2="91" />
  <line x1="80" y1="91" x2="106" y2="91" />
  <line x1="80" y1="91" x2="106" y2="91" />
  <line x1="80" y1="92" x2="106" y2="92" />
  <line x1="80" y1="92" x2="106" y2="92" />
  <line x1="80" y1="92" x2="106" y2="92" />
  <line x1="80" y1="93" x2="106" y2="93" />
  <line x1="80" y1="94" x2="106" y2="94" />
  <line x1="80" y1="95" x2="106" y2="95" />
  <line x1="80" y1="96" x2="106" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2" />
  <line x1="106" y1="70" x2="106" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.588235,70.588235 106.000852,70.588235 106.000852,96.000852 80.588235,96.000852" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.294544" y="116.000852" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="126.000852" y="83.294544" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,126.000852,83.294544)">1571</text>
  <text x="35.294118" y="80.706734" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,80.706734)">52226568</text>
</svg>
</td>
</tr>
</table></div></div>
</div>
<p>Data can be read into memory as numpy arrays, e.g., read genotypes for the first 5 SNPs and the first 3 samples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">gt</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[0, 0],
        [0, 0],
        [0, 0]],

       [[0, 0],
        [0, 0],
        [0, 0]],

       [[0, 0],
        [0, 0],
        [0, 0]],

       [[0, 0],
        [0, 0],
        [0, 0]],

       [[0, 0],
        [0, 0],
        [0, 0]]], dtype=int8)
</pre></div>
</div>
</div>
</div>
<p>If you want to work with the genotype calls, you may find it convenient to use <a class="reference external" href="http://scikit-allel.readthedocs.org/">scikit-allel</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="o">!</span>pip install -q scikit-allel
</pre></div>
</div>
</div>
</div>
<p>E.g., this code sets up a genotype array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the scikit-allel wrapper class for genotype calls</span>
<span class="kn">import</span> <span class="nn">allel</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">snp_genotypes</span><span class="p">(</span><span class="s2">&quot;3R&quot;</span><span class="p">,</span> <span class="n">sample_sets</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;AG1000G-BF-A&quot;</span><span class="p">,</span> <span class="s2">&quot;AG1000G-BF-B&quot;</span><span class="p">])</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">allel</span><span class="o">.</span><span class="n">GenotypeDaskArray</span><span class="p">(</span><span class="n">gt</span><span class="p">)</span>
<span class="n">gt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class="allel allel-DisplayAs2D"><span>&lt;GenotypeDaskArray shape=(52226568, 283, 2) dtype=int8&gt;</span><table><thead><tr><th></th><th style="text-align: center">0</th><th style="text-align: center">1</th><th style="text-align: center">2</th><th style="text-align: center">3</th><th style="text-align: center">4</th><th style="text-align: center">...</th><th style="text-align: center">278</th><th style="text-align: center">279</th><th style="text-align: center">280</th><th style="text-align: center">281</th><th style="text-align: center">282</th></tr></thead><tbody><tr><th style="text-align: center; background-color: white; border-right: 1px solid black; ">0</th><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">...</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td></tr><tr><th style="text-align: center; background-color: white; border-right: 1px solid black; ">1</th><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">...</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td></tr><tr><th style="text-align: center; background-color: white; border-right: 1px solid black; ">2</th><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">...</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td><td style="text-align: center">0/0</td></tr><tr><th style="text-align: center; background-color: white; border-right: 1px solid black; ">...</th><td style="text-align: center" colspan="12">...</td></tr><tr><th style="text-align: center; background-color: white; border-right: 1px solid black; ">52226565</th><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">...</td><td style="text-align: center">0/0</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td></tr><tr><th style="text-align: center; background-color: white; border-right: 1px solid black; ">52226566</th><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">...</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td></tr><tr><th style="text-align: center; background-color: white; border-right: 1px solid black; ">52226567</th><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">...</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td><td style="text-align: center">./.</td></tr></tbody></table></div></div></div>
</div>
<p>Here’s an example computation to count the number of segregating SNPs on chromosome arm 3R that also pass gamb_colu_arab site filters. This may take a little while, because it is scanning genotype calls at millions of SNPs in hundreds of samples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import dask progress bar</span>
<span class="kn">from</span> <span class="nn">dask.diagnostics.progress</span> <span class="kn">import</span> <span class="n">ProgressBar</span>

<span class="c1"># import numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># choose chromosome arm</span>
<span class="n">contig</span> <span class="o">=</span> <span class="s2">&quot;3R&quot;</span>

<span class="c1"># choose site filter mask</span>
<span class="n">mask</span> <span class="o">=</span> <span class="s2">&quot;gamb_colu_arab&quot;</span>

<span class="c1"># choose sample sets</span>
<span class="n">sample_sets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AG1000G-BF-A&quot;</span><span class="p">,</span> <span class="s2">&quot;AG1000G-BF-B&quot;</span><span class="p">]</span>

<span class="c1"># locate pass sites</span>
<span class="n">loc_pass</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">site_filters</span><span class="p">(</span><span class="n">contig</span><span class="o">=</span><span class="n">contig</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="c1"># perform an allele count over genotypes</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">ag3</span><span class="o">.</span><span class="n">snp_genotypes</span><span class="p">(</span><span class="n">contig</span><span class="o">=</span><span class="n">contig</span><span class="p">,</span> <span class="n">sample_sets</span><span class="o">=</span><span class="n">sample_sets</span><span class="p">)</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">allel</span><span class="o">.</span><span class="n">GenotypeDaskArray</span><span class="p">(</span><span class="n">gt</span><span class="p">)</span>
<span class="n">ac</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">count_alleles</span><span class="p">(</span><span class="n">max_allele</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># locate segregating sites</span>
<span class="n">loc_seg</span> <span class="o">=</span> <span class="n">ac</span><span class="o">.</span><span class="n">is_segregating</span><span class="p">()</span>

<span class="c1"># count segregating and pass sites</span>
<span class="n">n_pass_seg</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">loc_pass</span> <span class="o">&amp;</span> <span class="n">loc_seg</span><span class="p">)</span>

<span class="c1"># run the computation</span>
<span class="k">with</span> <span class="n">ProgressBar</span><span class="p">():</span>
    <span class="n">n_pass_seg</span> <span class="o">=</span> <span class="n">n_pass_seg</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">n_pass_seg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[########################################] | 100% Completed |  3min  6.7s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11226723
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="running-larger-computations">
<h2>Running larger computations<a class="headerlink" href="#running-larger-computations" title="Permalink to this headline">¶</a></h2>
<p>Please note that free cloud computing services such as Google Colab and MyBinder provide only limited computing resources. Thus although these services are able to efficiently read Ag3 data stored on Google Cloud, you may find that you run out of memory, or computations take a long time running on a single core. If you would like any suggestions regarding how to set up more powerful compute resources in the cloud, please feel free to get in touch via the <a class="reference external" href="https://github.com/malariagen/vector-data/discussions">malariagen/vector-data GitHub discussion board</a>.</p>
</div>
<div class="section" id="feedback-and-suggestions">
<h2>Feedback and suggestions<a class="headerlink" href="#feedback-and-suggestions" title="Permalink to this headline">¶</a></h2>
<p>If there are particular analyses you would like to run, or if you have other suggestions for useful documentation we could add to this site, we would love to know, please get in touch via the <a class="reference external" href="https://github.com/malariagen/vector-data/discussions">malariagen/vector-data GitHub discussion board</a>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ag3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">Introduction to Ag3</a>
    <a class='right-next' id="next-link" href="download.html" title="next page">Ag3 data downloads</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By MalariaGEN<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>